<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ivy.vis.tree &mdash; ivy 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="ivy 0.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">ivy 0.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ivy.vis.tree</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">interactive viewers for trees, etc. using matplotlib</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">bisect</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">types</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">tree</span><span class="p">,</span> <span class="n">bipart</span>
<span class="kn">from</span> <span class="nn">..layout</span> <span class="kn">import</span> <span class="n">cartesian</span>
<span class="kn">from</span> <span class="nn">..storage</span> <span class="kn">import</span> <span class="n">Storage</span>
<span class="kn">from</span> <span class="nn">ivy</span> <span class="kn">import</span> <span class="n">pyperclip</span> <span class="k">as</span> <span class="n">clipboard</span>
<span class="c">#from ..nodecache import NodeCache</span>
<span class="kn">import</span> <span class="nn">matplotlib</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">SubplotParams</span><span class="p">,</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.axes</span> <span class="kn">import</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">subplot_class_factory</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">PathPatch</span><span class="p">,</span> <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Arc</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">RectangleSelector</span>
<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">offset_copy</span><span class="p">,</span> <span class="n">IdentityTransform</span><span class="p">,</span> \
     <span class="n">Affine2D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span> <span class="k">as</span> <span class="n">mpl_colormap</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">mpl_colors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">import</span> <span class="n">Colorbar</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">RegularPolyCollection</span><span class="p">,</span> <span class="n">LineCollection</span><span class="p">,</span> \
     <span class="n">PatchCollection</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">OffsetImage</span><span class="p">,</span> <span class="n">AnnotationBbox</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="kn">from</span> <span class="nn">matplotlib._png</span> <span class="kn">import</span> <span class="n">read_png</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span><span class="p">,</span> <span class="n">FuncFormatter</span><span class="p">,</span> <span class="n">NullLocator</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid.anchored_artists</span> <span class="kn">import</span> <span class="n">AnchoredText</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="kn">import</span> <span class="nn">symbols</span><span class="o">,</span> <span class="nn">colors</span>
<span class="kn">import</span> <span class="nn">hardcopy</span> <span class="kn">as</span> <span class="nn">HC</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">Image</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="c">#matplotlib.rcParams[&#39;path.simplify&#39;] = False</span>

<span class="n">_tango</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">tango</span><span class="p">()</span>
<div class="viewcode-block" id="TreeFigure"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure">[docs]</a><span class="k">class</span> <span class="nc">TreeFigure</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Window for showing a single tree, optionally with split overview</span>
<span class="sd">    and detail panes.</span>

<span class="sd">    The navigation toolbar at the bottom is provided by matplotlib</span>
<span class="sd">    (http://matplotlib.sf.net/users/navigation_toolbar.html).  Its</span>
<span class="sd">    pan/zoom button and zoom-rectangle button provide different modes</span>
<span class="sd">    of mouse interaction with the figure.  When neither of these</span>
<span class="sd">    buttons are checked, the default mouse bindings are as follows:</span>

<span class="sd">    * button 1 drag: select nodes - retrieve by calling fig.selected</span>
<span class="sd">    * button 3 drag: pan view</span>
<span class="sd">    * scroll up/down: zoom in/out</span>
<span class="sd">    * scroll up/down with Control key: zoom y-axis</span>
<span class="sd">    * scroll up/down with Shift key: zoom x-axis</span>
<span class="sd">    * scroll up/down with &#39;d&#39; key: pan view up/down</span>
<span class="sd">    * scroll up/down with &#39;e&#39; key: pan view left/right</span>
<span class="sd">    * click on overview will center the detail pane on that region</span>

<span class="sd">    Default keybindings:</span>

<span class="sd">    * t: zoom out to full extent</span>
<span class="sd">    * +/-: zoom in/out</span>

<span class="sd">    Useful attributes and methods (assume an instance named *fig*):</span>

<span class="sd">    * fig.root - the root node (see [Node methods])</span>
<span class="sd">    * fig.highlight(s) - highlight and trace nodes with substring *s*</span>
<span class="sd">    * fig.zoom_clade(anc) - zoom to view node *anc* and all its descendants</span>
<span class="sd">    * fig.toggle_overview() - toggle visibility of the overview pane</span>
<span class="sd">    * fig.toggle_branchlabels() - ditto for branch labels</span>
<span class="sd">    * fig.toggle_leaflabels() - ditto for leaf labels</span>
<span class="sd">    * fig.decorate(func) - decorate the tree with a function (see</span>
<span class="sd">      :ref:`decorating TreeFigures &lt;decorating-trees&gt;`)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">div</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                 <span class="n">branchlabels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mark_named</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">highlight_support</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">overview</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">radial</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overview</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="n">div</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataplot_width</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">branchlabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="n">leaflabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span> <span class="o">=</span> <span class="n">mark_named</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xoff</span> <span class="o">=</span> <span class="n">xoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span> <span class="o">=</span> <span class="n">yoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radial</span> <span class="o">=</span> <span class="n">radial</span>
        <span class="k">if</span> <span class="n">radial</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span> <span class="o">=</span> <span class="n">highlight_support</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">,</span> <span class="s">&quot;cannot coerce data into tree.Node&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="n">root</span><span class="o">.</span><span class="n">treename</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">SubplotParams</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.01</span>
            <span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">subplotpars</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">connect_events</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_subplots</span><span class="p">(</span><span class="n">overview</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>

<div class="viewcode-block" id="TreeFigure.initialize_subplots"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.initialize_subplots">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_subplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overview</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">radial</span><span class="p">:</span>
            <span class="n">tp</span> <span class="o">=</span> <span class="n">TreePlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                          <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">branchlabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                          <span class="n">highlight_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span><span class="p">,</span>
                          <span class="n">leaflabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                          <span class="n">mark_named</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">)</span>
            <span class="n">detail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
            <span class="n">detail</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="n">detail</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">detail</span> <span class="o">=</span> <span class="n">detail</span>
            <span class="n">tp</span> <span class="o">=</span> <span class="n">OverviewTreePlot</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span>
                <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">mark_named</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">,</span>
                <span class="n">highlight_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span><span class="p">,</span>
                <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">detail</span>
                <span class="p">)</span>
            <span class="n">ov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
            <span class="n">ov</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="n">ov</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span> <span class="o">=</span> <span class="n">ov</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">overview</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggle_overview</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">nleaves</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggle_overview</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tp</span> <span class="o">=</span> <span class="n">RadialTreePlot</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">branchlabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                <span class="n">highlight_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span><span class="p">,</span>
                <span class="n">leaflabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span> <span class="n">mark_named</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span>
                <span class="p">)</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">detail</span> <span class="o">=</span> <span class="n">ax2</span>
</div>
    <span class="k">def</span> <span class="nf">__get_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">selected_nodes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__del_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="n">selected</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_selected_nodes</span><span class="p">,</span>
                        <span class="n">__set_selected_nodes</span><span class="p">,</span>
                        <span class="n">__del_selected_nodes</span><span class="p">)</span>

    <span class="c">## def selected_nodes(self):</span>
    <span class="c">##     return self.detail.selected_nodes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span>

<div class="viewcode-block" id="TreeFigure.add"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
            <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new tree in a new window</span>

<span class="sd">        Args:</span>
<span class="sd">            data: A node object or tree file.</span>
<span class="sd">            name (str): Name of the plot. Defaults to None</span>
<span class="sd">            branchlabels (bool): Whether or not to draw branch labels.</span>
<span class="sd">              Defaults to False</span>
<span class="sd">            leaflabels (bool): Whether or not to draw leaf labels.</span>
<span class="sd">              Defaults to True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newfig</span> <span class="o">=</span> <span class="n">MultiTreeFigure</span><span class="p">()</span>
        <span class="c">## newfig.add(self.root, name=self.name, support=self.support,</span>
        <span class="c">##            branchlabels=self.branchlabels)</span>
        <span class="n">newfig</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
                   <span class="n">branchlabels</span><span class="o">=</span><span class="n">branchlabels</span><span class="p">,</span>
                   <span class="n">leaflabels</span><span class="o">=</span><span class="n">leaflabels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newfig</span>
</div>
<div class="viewcode-block" id="TreeFigure.toggle_leaflabels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.toggle_leaflabels">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_leaflabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle leaf labels and redraw tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.toggle_branchlabels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.toggle_branchlabels">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_branchlabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle branch labels and redraw tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.toggle_overview"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.toggle_overview">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_overview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle overview</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="mf">0.001</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="k">elif</span> <span class="n">val</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.set_scaled"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.set_scaled">[docs]</a>    <span class="k">def</span> <span class="nf">set_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RR: Using this method gives the error:</span>
<span class="sd">            redraw takes exactly 1 argument(2 given)-CZ</span>
<span class="sd">        Define whether or not the tree is scaled and redraw tree</span>

<span class="sd">        Args:</span>
<span class="sd">            scaled (bool): Whether or not the tree is scaled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">redraw</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">set_scaled</span><span class="p">(</span><span class="n">scaled</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.on_nodes_selected"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.on_nodes_selected">[docs]</a>    <span class="k">def</span> <span class="nf">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treeplot</span><span class="p">):</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="TreeFigure.picked"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.picked">[docs]</a>    <span class="k">def</span> <span class="nf">picked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">button</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
                <span class="n">clipboard</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="k">print</span> <span class="n">s</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="TreeFigure.ladderize"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.ladderize">[docs]</a>    <span class="k">def</span> <span class="nf">ladderize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rev</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ladderize and redraw the tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">ladderize</span><span class="p">(</span><span class="n">rev</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.show"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the figure in a new window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.set_positions"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.set_positions">[docs]</a>    <span class="k">def</span> <span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ov</span><span class="p">:</span>
            <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span><span class="p">,</span> <span class="n">height</span><span class="p">]</span>
            <span class="n">ov</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">ov</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span>
        <span class="k">if</span> <span class="n">dp</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataplot_width</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">(),</span> <span class="n">w</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dp</span><span class="p">:</span>
            <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dataplot_width</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">(),</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">dataplot_width</span><span class="p">,</span> <span class="n">height</span><span class="p">]</span>
            <span class="n">dp</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="c">## def div(self, v=0.3):</span>
    <span class="c">##     assert 0 &lt;= v &lt; 1</span>
    <span class="c">##     self.overview_width = v</span>
    <span class="c">##     self.set_positions()</span>
    <span class="c">##     self.figure.canvas.draw_idle()</span>
</div>
<div class="viewcode-block" id="TreeFigure.add_dataplot"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.add_dataplot">[docs]</a>    <span class="k">def</span> <span class="nf">add_dataplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add new plot to the side of existing plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">np</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span> <span class="k">else</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="p">)</span>
        <span class="c"># left, bottom, width, height (proportions)</span>
        <span class="n">dleft</span><span class="p">,</span> <span class="n">dbottom</span><span class="p">,</span> <span class="n">dwidth</span><span class="p">,</span> <span class="n">dheight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">bounds</span>
        <span class="c"># give the dataplot one-quarter the width of the detail axes</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">dwidth</span> <span class="o">*</span> <span class="mf">0.25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">dleft</span><span class="p">,</span> <span class="n">dbottom</span><span class="p">,</span> <span class="n">dwidth</span><span class="o">-</span><span class="n">w</span><span class="p">,</span> <span class="n">dheight</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="n">w</span><span class="p">,</span> <span class="n">dbottom</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">dheight</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">x</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataplot</span>
</div>
<div class="viewcode-block" id="TreeFigure.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replot the figure and overview</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.find"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find nodes</span>

<span class="sd">        Args:</span>
<span class="sd">            x (str): String to search</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: A list of node objects found with the Node findall() method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.hlines"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.hlines">[docs]</a>    <span class="k">def</span> <span class="nf">hlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Highlight nodes</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes (list): A list of node objects</span>
<span class="sd">            width (float): Width of highlighted lines. Defaults to 5</span>
<span class="sd">            color (str): Color of highlighted lines. Defaults to red</span>
<span class="sd">            xoff (float): Number of units to offset lines by. Defaults to 0</span>
<span class="sd">            yoff (float): Number of units to offset lines by. Defaults to 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                             <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                           <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.highlight"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Highlight nodes</span>

<span class="sd">        Args:</span>
<span class="sd">            x: Str or list of Strs or Node or list of Nodes</span>
<span class="sd">            width (float): Width of highlighted lines. Defaults to 5</span>
<span class="sd">            color (str): Color of highlighted lines. Defaults to red</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">types</span><span class="o">.</span><span class="n">StringTypes</span><span class="p">:</span>
                <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
                <span class="n">nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="n">types</span><span class="o">.</span><span class="n">StringTypes</span><span class="p">:</span>
                        <span class="n">found</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                            <span class="n">nodes</span> <span class="o">|=</span> <span class="nb">set</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
                        <span class="n">nodes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="n">nodes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return plot to initial size and location.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.zoom_clade"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.zoom_clade">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_clade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom to fit a node *x* and all its descendants in the view.</span>

<span class="sd">        Args:</span>
<span class="sd">            x: Node or str that matches the label of a node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">zoom_clade</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.zoom"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.zoom">[docs]</a>    <span class="k">def</span> <span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zoom both axes by *factor* (relative display size).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.zx"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.zx">[docs]</a>    <span class="k">def</span> <span class="nf">zx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zoom x axis by *factor*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.zy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.zy">[docs]</a>    <span class="k">def</span> <span class="nf">zy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zoom y axis by *factor*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decorate the tree.</span>

<span class="sd">        Args:</span>
<span class="sd">            func (function): A function that takes a TreePlot instance as the</span>
<span class="sd">              first parameter, and *args* and *kwargs* as additional</span>
<span class="sd">              parameters.  It adds boxes, circles, etc to the TreePlot.</span>

<span class="sd">        Notes:</span>
<span class="sd">            If *kwargs* contains the key-value pair (&#39;store&#39;, *name*),</span>
<span class="sd">            then the function is stored as *name* and re-called every time</span>
<span class="sd">            the TreePlot is redrawn, i.e., the decoration is persistent.</span>
<span class="sd">            Use ``rmdec(name)`` to remove the decorator from the treeplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">decorate</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="TreeFigure.rmdec"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.rmdec">[docs]</a>    <span class="k">def</span> <span class="nf">rmdec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="s">&quot;Remove the decoration &#39;name&#39;.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">rmdec</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="c">## if name in self.detail.decorators:</span>
        <span class="c">##     del self.detail.decorators[name]</span>
</div>
<div class="viewcode-block" id="TreeFigure.cbar"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.cbar">[docs]</a>    <span class="k">def</span> <span class="nf">cbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">mrca</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="c"># self.axes.cbar(nodes = node, width = width, color = color, mrca = mrca)</span>
</div>
<div class="viewcode-block" id="TreeFigure.unclutter"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.unclutter">[docs]</a>    <span class="k">def</span> <span class="nf">unclutter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">unclutter</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.trace_branches"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.trace_branches">[docs]</a>    <span class="k">def</span> <span class="nf">trace_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RR: What is the difference between this and highlight? -CZ</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">trace_branches</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.plot_continuous"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.plot_continuous">[docs]</a>    <span class="k">def</span> <span class="nf">plot_continuous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">plot_continuous</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.hardcopy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.hardcopy">[docs]</a>    <span class="k">def</span> <span class="nf">hardcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relwidth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">leafpad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">relwidth</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">())</span>
            <span class="n">relwidth</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">hardcopy</span><span class="p">(</span>
            <span class="n">relwidth</span><span class="o">=</span><span class="n">relwidth</span><span class="p">,</span>
            <span class="n">leafpad</span><span class="o">=</span><span class="n">leafpad</span>
            <span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="c">#f.axes.set_xlim(*self.detail.get_xlim())</span>
        <span class="c">#f.axes.set_ylim(*self.detail.get_ylim())</span>
        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>
</div>
<div class="viewcode-block" id="TreeFigure.select_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.select_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">select_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select nodes on the plot</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes: A node or list of ndoes</span>
<span class="sd">        Notes:</span>
<span class="sd">            If only one node is given, all of the node&#39;s ancestors are</span>
<span class="sd">            also selected. If a list of nodes is given (even if it has only</span>
<span class="sd">            one node), only the given node(s) are selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.decorate"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.decorate">[docs]</a>    <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c"># RR: is this repeated from above? -CZ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">decorate</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c">## def dataplot(self):</span>
    <span class="c">##     ax = self.figure.add_subplot(133, sharey=self.detail)</span>
    <span class="c">##     ax.yaxis.set_visible(False)</span>
    <span class="c">##     self.dataplot = ax</span>
    <span class="c">##     return ax</span>
</div>
<div class="viewcode-block" id="TreeFigure.attach_alignment"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.TreeFigure.attach_alignment">[docs]</a>    <span class="k">def</span> <span class="nf">attach_alignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aln</span><span class="p">,</span> <span class="n">overview</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="s">&quot;leaf labels expected to be sequence ids&quot;</span>
        <span class="kn">from</span> <span class="nn">Bio.Align</span> <span class="kn">import</span> <span class="n">MultipleSeqAlignment</span>
        <span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
        <span class="kn">from</span> <span class="nn">Bio.SeqRecord</span> <span class="kn">import</span> <span class="n">SeqRecord</span>
        <span class="kn">from</span> <span class="nn">Bio.Alphabet</span> <span class="kn">import</span> <span class="n">IUPAC</span>
        <span class="kn">from</span> <span class="nn">alignment</span> <span class="kn">import</span> <span class="n">AlignmentFigure</span><span class="p">,</span> <span class="n">AlignmentPlot</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aln</span><span class="p">,</span> <span class="n">MultipleSeqAlignment</span><span class="p">):</span>
            <span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">align</span>
            <span class="n">aln</span> <span class="o">=</span> <span class="n">align</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">aln</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aln</span> <span class="p">])</span>
        <span class="n">emptyseq</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="o">*</span><span class="n">aln</span><span class="o">.</span><span class="n">get_alignment_length</span><span class="p">(),</span>
                       <span class="n">alphabet</span><span class="o">=</span><span class="n">IUPAC</span><span class="o">.</span><span class="n">ambiguous_dna</span><span class="p">)</span>
        <span class="n">aln</span> <span class="o">=</span> <span class="n">MultipleSeqAlignment</span><span class="p">(</span>
            <span class="p">[</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">label</span><span class="p">)</span> <span class="ow">or</span> <span class="n">SeqRecord</span><span class="p">(</span><span class="n">emptyseq</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">leaves</span><span class="p">()</span> <span class="p">]</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aln</span> <span class="o">=</span> <span class="n">aln</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">AlignmentPlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="n">aln</span><span class="o">=</span><span class="n">aln</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                          <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">showy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alnplot</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alnplot</span><span class="o">.</span><span class="n">detail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">detail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alnplot</span><span class="o">.</span><span class="n">detail</span>
        <span class="n">detail</span><span class="o">.</span><span class="n">plot_aln</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">overview</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alnplot</span><span class="o">.</span><span class="n">overview</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span>
                <span class="n">detail</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s">&quot;30%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s">&quot;20%&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>
            <span class="n">overview</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alnplot</span><span class="o">.</span><span class="n">overview</span>
            <span class="n">overview</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
            <span class="n">overview</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">NullLocator</span><span class="p">())</span>
            <span class="n">overview</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
                <span class="n">detail</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">origin</span><span class="o">=</span><span class="s">&#39;lower&#39;</span>
                <span class="p">)</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">UpdatingRect</span><span class="p">(</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
                <span class="p">)</span>
            <span class="n">overview</span><span class="o">.</span><span class="n">zoomrect</span> <span class="o">=</span> <span class="n">rect</span>
            <span class="n">rect</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">detail</span>
            <span class="n">detail</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;xlim_changed&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
            <span class="n">detail</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;ylim_changed&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
            <span class="n">overview</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">rect</span><span class="p">(</span><span class="n">overview</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle_overview</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">xoffset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detail</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">xoff</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">xoff</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">xoff</span><span class="p">])</span>

</div></div>
<div class="viewcode-block" id="MultiTreeFigure"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure">[docs]</a><span class="k">class</span> <span class="nc">MultiTreeFigure</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Window for showing multiple trees side-by-side.</span>

<span class="sd">    TODO: document this</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trees</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                 <span class="n">scaled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">radial</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *trees* are assumed to be objects suitable for passing to</span>
<span class="sd">        ivy.tree.read()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">branchlabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radial</span> <span class="o">=</span> <span class="n">radial</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">divs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">SubplotParams</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.04</span>
            <span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">subplotpars</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>
        <span class="n">connect_events</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">trees</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="n">scaled</span><span class="p">,</span>
                     <span class="n">branchlabels</span><span class="o">=</span><span class="n">branchlabels</span><span class="p">)</span>

<div class="viewcode-block" id="MultiTreeFigure.on_nodes_selected"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.on_nodes_selected">[docs]</a>    <span class="k">def</span> <span class="nf">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treeplot</span><span class="p">):</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.clear"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">divs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.picked"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.picked">[docs]</a>    <span class="k">def</span> <span class="nf">picked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">button</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">e</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.getplot"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.getplot">[docs]</a>    <span class="k">def</span> <span class="nf">getplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.add"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">,</span> <span class="s">&quot;cannot coerce data into tree.Node&quot;</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">root</span><span class="o">.</span><span class="n">treename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">):</span>
            <span class="n">p</span><span class="o">.</span><span class="n">change_geometry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span> <span class="o">=</span> <span class="n">TreePlot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
                       <span class="n">scaled</span><span class="o">=</span><span class="n">scaled</span><span class="p">,</span> <span class="n">branchlabels</span><span class="o">=</span><span class="n">branchlabels</span><span class="p">,</span>
                       <span class="n">leaflabels</span><span class="o">=</span><span class="n">leaflabels</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">plt</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
        <span class="n">p</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>

        <span class="c">## global IP</span>
        <span class="c">## if IP:</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.highlight(s)</span>
        <span class="c">##         return sorted([ x.label for x in self.highlighted ])</span>
        <span class="c">##     IP.expose_magic(&quot;highlight&quot;, f)</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.root.ladderize()</span>
        <span class="c">##         self.redraw()</span>
        <span class="c">##     IP.expose_magic(&quot;ladderize&quot;, f)</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.show()</span>
        <span class="c">##     IP.expose_magic(&quot;show&quot;, f)</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.redraw()</span>
        <span class="c">##     IP.expose_magic(&quot;redraw&quot;, f)</span>
        <span class="k">return</span> <span class="n">p</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.show"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.ladderize"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.ladderize">[docs]</a>    <span class="k">def</span> <span class="nf">ladderize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">ladderize</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.highlight"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Highlight nodes</span>

<span class="sd">        Args:</span>
<span class="sd">            s: Str or list of Strs or Node or list of Nodes</span>
<span class="sd">            add (bool): Whether to add to existing highlighted nodes or</span>
<span class="sd">              overwrite them.</span>
<span class="sd">            width (float): Width of highlighted lines. Defaults to 5</span>
<span class="sd">            color (str): Color of highlighted lines. Defaults to red</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="n">nodesets</span> <span class="o">=</span> <span class="p">[</span> <span class="n">p</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="p">]</span>

        <span class="k">for</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodesets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="n">nodesets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

        <span class="c">##     for root in self.root:</span>
        <span class="c">##         for node in root.iternodes():</span>
        <span class="c">##             if node.label and (s in node.label):</span>
        <span class="c">##                 self.highlighted.add(node)</span>
        <span class="c">## self.highlight()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.MultiTreeFigure.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="connect_events"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.connect_events">[docs]</a><span class="k">def</span> <span class="nf">connect_events</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
    <span class="n">mpl_connect</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;button_release_event&quot;</span><span class="p">,</span> <span class="n">onbuttonrelease</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;scroll_event&quot;</span><span class="p">,</span> <span class="n">onscroll</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;pick_event&quot;</span><span class="p">,</span> <span class="n">onpick</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;motion_notify_event&quot;</span><span class="p">,</span> <span class="n">ondrag</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;key_press_event&quot;</span><span class="p">,</span> <span class="n">onkeypress</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;axes_enter_event&quot;</span><span class="p">,</span> <span class="n">axes_enter</span><span class="p">)</span>
    <span class="n">mpl_connect</span><span class="p">(</span><span class="s">&quot;axes_leave_event&quot;</span><span class="p">,</span> <span class="n">axes_leave</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UpdatingRect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.UpdatingRect">[docs]</a><span class="k">class</span> <span class="nc">UpdatingRect</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree">[docs]</a><span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Axes</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    matplotlib.axes.Axes subclass for rendering trees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;app&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">support</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;support&quot;</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;scaled&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;leaflabels&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branchlabels&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_named</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;mark_named&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;leaf_fontsize&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branch_fontsize&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branch_width&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branch_color&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;interactive&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;decorators&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="c">## if self.decorators:</span>
        <span class="c">##     print &gt;&gt; sys.stderr, &quot;got %s decorators&quot; % len(self.decorators)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xoff</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;xoff&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;yoff&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;highlight_support&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smooth_xpos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;smooth_xpos&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">Axes</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pan_start</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s">&quot;__selected_nodes__&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Tree</span><span class="o">.</span><span class="n">highlight_selected_nodes</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{}))</span>
                <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span>
                               <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">)</span> <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_active</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;ylim_changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="n">RectangleSelector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rectselect</span><span class="p">,</span>
                                          <span class="n">useblit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">RectangleSelector</span><span class="o">.</span><span class="n">ignore</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xoffset_value</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_offset</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_valign</span> <span class="o">=</span> <span class="s">&quot;center&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_halign</span> <span class="o">=</span> <span class="s">&quot;left&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_offset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_valign</span> <span class="o">=</span> <span class="s">&quot;center&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_halign</span> <span class="o">=</span> <span class="s">&quot;right&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">&quot;bottom&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Tree.p2y"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.p2y">[docs]</a>    <span class="k">def</span> <span class="nf">p2y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Convert a single display point to y-units&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="k">return</span> <span class="n">transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Tree.p2x"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.p2x">[docs]</a>    <span class="k">def</span> <span class="nf">p2x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Convert a single display point to y-units&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="k">return</span> <span class="n">transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">transform</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Tree.decorate"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.decorate">[docs]</a>    <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decorate the tree with function *func*.  If *kwargs* contains</span>
<span class="sd">        the key-value pair (&#39;store&#39;, *name*), the decorator function</span>
<span class="sd">        is stored in self.decorators and called upon every redraw.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;store&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span>
                                       <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">)</span> <span class="p">])</span>

        <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.rmdec"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.rmdec">[docs]</a>    <span class="k">def</span> <span class="nf">rmdec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name2dec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span>
                                   <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">)</span> <span class="p">])</span>

</div>
<div class="viewcode-block" id="Tree.flip"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reverse the direction of the x-axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_offset</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_offset</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">ha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_halign</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_halign</span> <span class="o">=</span> <span class="s">&quot;right&quot;</span> <span class="k">if</span> <span class="n">ha</span> <span class="o">==</span> <span class="s">&quot;left&quot;</span> <span class="k">else</span> <span class="s">&quot;left&quot;</span>
        <span class="n">ha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branch_halign</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_halign</span> <span class="o">=</span> <span class="s">&quot;right&quot;</span> <span class="k">if</span> <span class="n">ha</span> <span class="o">==</span> <span class="s">&quot;left&quot;</span> <span class="k">else</span> <span class="s">&quot;left&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.xoffset"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.xoffset">[docs]</a>    <span class="k">def</span> <span class="nf">xoffset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Space below x axis to show tick labels.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xoffset_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
</div>
<div class="viewcode-block" id="Tree.save_newick"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.save_newick">[docs]</a>    <span class="k">def</span> <span class="nf">save_newick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save tree as a newick file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): Path to file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&quot;File </span><span class="si">%s</span><span class="s"> exists, enter &#39;y&#39; to overwrite &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;y&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">s</span><span class="p">):</span>
                <span class="k">return</span>
        <span class="kn">import</span> <span class="nn">newick</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">newick</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.set_scaled"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.set_scaled">[docs]</a>    <span class="k">def</span> <span class="nf">set_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">!=</span> <span class="n">scaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span>
        <span class="k">return</span> <span class="n">flag</span>
</div>
<div class="viewcode-block" id="Tree.cbar"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.cbar">[docs]</a>    <span class="k">def</span> <span class="nf">cbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
             <span class="n">showlabel</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mrca</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw a &#39;clade&#39; bar (i.e., along the y-axis) indicating a</span>
<span class="sd">        clade.  *nodes* are assumed to be one or more nodes in the</span>
<span class="sd">        tree.  If just one, it should be the internal node</span>
<span class="sd">        representing the clade of interest; otherwise, the clade of</span>
<span class="sd">        interest is the most recent common ancestor of the specified</span>
<span class="sd">        nodes.  *label* is an optional string to be drawn next to the</span>
<span class="sd">        bar, *offset* by the specified number of display units.  If</span>
<span class="sd">        *label* is ``None`` then the clade&#39;s label is used instead.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes: Node or list of nodes</span>
<span class="sd">            color (str): Color of the bar. Optional, defaults to None.</span>
<span class="sd">            label (str): Optional label for bar. If None, the clade&#39;s</span>
<span class="sd">              label is used instead. Defaults to None.</span>
<span class="sd">            width (float): Width of bar</span>
<span class="sd">            xoff (float): Offset from label to bar</span>
<span class="sd">            showlabel (bool): Whether or not to draw the label</span>
<span class="sd">            mrca: RR: Not quite sure what this does -CZ</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">();</span> <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">color</span> <span class="o">=</span> <span class="n">_tango</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>

        <span class="k">if</span> <span class="n">mrca</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">nodes</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="ow">in</span> <span class="n">types</span><span class="o">.</span><span class="n">StringTypes</span><span class="p">:</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

            <span class="k">assert</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="ow">or</span> <span class="n">spec</span><span class="o">.</span><span class="n">label</span>
            <span class="n">leaves</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">leaves</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">leaves</span> <span class="o">=</span> <span class="n">nodes</span>

        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>

        <span class="n">y</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">leaves</span> <span class="p">])</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span><span class="o">+</span><span class="n">ymin</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">leaves</span> <span class="p">])</span>
            <span class="n">_x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">lf</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">txt</span> <span class="ow">and</span> <span class="n">txt</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                    <span class="n">_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">transform</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">())[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">_x</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">_x</span>

        <span class="n">v</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">transform</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">xoff</span><span class="p">,</span><span class="mi">0</span><span class="p">)))[:,</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="n">xoff</span>

        <span class="n">Axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">],</span> <span class="s">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">showlabel</span> <span class="ow">and</span> <span class="n">label</span><span class="p">:</span>
            <span class="n">xo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_offset</span>
            <span class="k">if</span> <span class="n">xo</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xo</span> <span class="o">+=</span> <span class="n">width</span><span class="o">*</span><span class="mf">0.5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xo</span> <span class="o">-=</span> <span class="n">width</span><span class="o">*</span><span class="mf">0.5</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="n">label</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xo</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s">&quot;offset points&quot;</span><span class="p">,</span>
                <span class="n">verticalalignment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_valign</span><span class="p">,</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_halign</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">,</span>
                <span class="n">clip_on</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">picker</span><span class="o">=</span><span class="bp">False</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.anctrace"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.anctrace">[docs]</a>    <span class="k">def</span> <span class="nf">anctrace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anc</span><span class="p">,</span> <span class="n">descendants</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RR: This function gives me a &#39;list index out of range&#39; error</span>
<span class="sd">        when I try to use it -CZ</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">descendants</span><span class="p">:</span>
            <span class="n">descendants</span> <span class="o">=</span> <span class="n">anc</span><span class="o">.</span><span class="n">leaves</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">descendants</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">anc</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">descendants</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">rootpath</span><span class="p">(</span><span class="n">anc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">nodes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">anc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trace_branches</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.trace_branches"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.trace_branches">[docs]</a>    <span class="k">def</span> <span class="nf">trace_branches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">):</span>
        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="p">[</span> <span class="p">(</span><span class="n">n2c</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">n2c</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nodes</span>
                       <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">n2c</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span> <span class="p">]:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
            <span class="n">px</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">y</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">verts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">p</span>
</div>
<div class="viewcode-block" id="Tree.highlight_selected_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.highlight_selected_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">highlight_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">get</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">[</span> <span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span> <span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__selected_highlight_patch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                                                           <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.select_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.select_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">select_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__selected_highlight_patch</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">|</span> <span class="n">nodes</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;app&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlight_selected_nodes</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="n">nodes</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;app&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">highlight_selected_nodes</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.rectselect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.rectselect">[docs]</a>    <span class="k">def</span> <span class="nf">rectselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>
        <span class="n">add</span> <span class="o">=</span> <span class="n">e0</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s">&#39;shift&#39;</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x0</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">):</span>
                <span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">add</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="c">## if s:</span>
        <span class="c">##     print &quot;Selected:&quot;</span>
        <span class="c">##     for n in s:</span>
        <span class="c">##         print &quot; &quot;, n</span>
</div>
<div class="viewcode-block" id="Tree.picked"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.picked">[docs]</a>    <span class="k">def</span> <span class="nf">picked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;app&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">picked</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.window2data"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.window2data">[docs]</a>    <span class="k">def</span> <span class="nf">window2data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expandx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">expandy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the data coordinates ((x0, y0),(x1, y1)) of the plot</span>
<span class="sd">        window, expanded by relative units of window size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
        <span class="n">bbx</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="n">expandx</span><span class="p">,</span> <span class="n">expandy</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bbx</span><span class="o">.</span><span class="n">get_points</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="Tree.get_visible_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.get_visible_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">get_visible_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labeled_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c">## transform = self.transData.inverted().transform</span>
        <span class="c">## bb = self.get_window_extent()</span>
        <span class="c">## bbx = bb.expanded(1.1,1.1)</span>
        <span class="c">## ((x0, y0),(x1, y1)) = transform(bbx.get_points())</span>
        <span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window2data</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
        <span class="c">#print &quot;visible_nodes points&quot;, x0, x1, y0, y1</span>

        <span class="k">if</span> <span class="n">labeled_only</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.zoom_cxy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.zoom_cxy">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_cxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom the x and y axes in by the specified proportion of the</span>
<span class="sd">        current view, with a fixed data point (cx, cy)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">();</span> <span class="n">xmid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">();</span> <span class="n">ymid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
        <span class="n">bbx</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="mf">1.0</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">bbx</span><span class="o">.</span><span class="n">get_points</span><span class="p">())</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">deltax</span> <span class="o">=</span> <span class="n">xmid</span><span class="o">-</span><span class="n">x0</span><span class="p">;</span> <span class="n">deltay</span> <span class="o">=</span> <span class="n">ymid</span><span class="o">-</span><span class="n">y0</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="n">cx</span> <span class="ow">or</span> <span class="n">xmid</span><span class="p">;</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">cy</span> <span class="ow">or</span> <span class="n">ymid</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">cx</span><span class="o">-</span><span class="n">xmid</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmid</span><span class="o">-</span><span class="n">deltax</span><span class="o">+</span><span class="n">xoff</span><span class="p">,</span> <span class="n">xmid</span><span class="o">+</span><span class="n">deltax</span><span class="o">+</span><span class="n">xoff</span><span class="p">)</span>
        <span class="n">yoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">cy</span><span class="o">-</span><span class="n">ymid</span><span class="p">)</span><span class="o">*</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymid</span><span class="o">-</span><span class="n">deltay</span><span class="o">+</span><span class="n">yoff</span><span class="p">,</span> <span class="n">ymid</span><span class="o">+</span><span class="n">deltay</span><span class="o">+</span><span class="n">yoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.zoom"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.zoom">[docs]</a>    <span class="k">def</span> <span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom the x and y axes in by the specified proportion of the</span>
<span class="sd">        current view.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># get the function to convert display coordinates to data</span>
        <span class="c"># coordinates</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
        <span class="n">bbx</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="mf">1.0</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">bbx</span><span class="o">.</span><span class="n">get_points</span><span class="p">())</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">deltax</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">deltay</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">deltax</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">deltax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">deltay</span><span class="p">,</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">deltay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.center_y"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.center_y">[docs]</a>    <span class="k">def</span> <span class="nf">center_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center the y-axis of the canvas on the given y value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">yoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yoff</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">yoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.center_x"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.center_x">[docs]</a>    <span class="k">def</span> <span class="nf">center_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center the x-axis of the canvas on the given x value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="n">xspan</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">xspan</span><span class="o">*</span><span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xoff</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">xoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.center_node"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.center_node">[docs]</a>    <span class="k">def</span> <span class="nf">center_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center the canvas on the given node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.do_highlight_support"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.do_highlight_support">[docs]</a>    <span class="k">def</span> <span class="nf">do_highlight_support</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TODO: reconfigure this, insert into self.decorators</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">support</span><span class="p">:</span>
            <span class="n">lim</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">support</span><span class="p">)</span>

        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>

        <span class="n">verts</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isleaf</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="k">return</span> <span class="bp">False</span>
            <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">label</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">lim</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">support</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">lim</span>
                <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">]:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">pcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
            <span class="n">px</span> <span class="o">=</span> <span class="n">pcoords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">y</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">radial</span><span class="p">:</span>
                <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">];</span> <span class="n">theta2</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">angle</span>
                <span class="n">px</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
                <span class="n">py</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">depth</span>

            <span class="c">## segments.append([(x, y),(px, y)])</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span><span class="n">py</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verts</span><span class="p">:</span>
            <span class="n">patch</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                              <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>

            <span class="c">## self.add_artist(Line2D(</span>
            <span class="c">##     [x,px], [y,py], lw=3, solid_capstyle=&quot;butt&quot;, color=&quot;black&quot;</span>
            <span class="c">##     ))</span>
</div>
<div class="viewcode-block" id="Tree.hl"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.hl">[docs]</a>    <span class="k">def</span> <span class="nf">hl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.hlines"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.hlines">[docs]</a>    <span class="k">def</span> <span class="nf">hlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">IdentityTransform</span><span class="p">()</span>
        <span class="n">segs</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">w</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">o</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">parent</span><span class="p">]</span>
            <span class="n">segs</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)))</span>
            <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">width</span><span class="p">);</span> <span class="n">o</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xoff</span><span class="p">,</span><span class="n">yoff</span><span class="p">))</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">(</span><span class="n">segs</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">transOffset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="n">o</span><span class="p">)</span>
        <span class="n">lc</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="n">Axes</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lc</span><span class="p">)</span>
        <span class="c">## self.drawstack.append((&quot;hlines&quot;, [nodes], dict(width=width,</span>
        <span class="c">##                                                color=color,</span>
        <span class="c">##                                                xoff=xoff,</span>
        <span class="c">##                                                yoff=yoff)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lc</span>
        
        
    
</div>
<div class="viewcode-block" id="Tree.hardcopy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.hardcopy">[docs]</a>    <span class="k">def</span> <span class="nf">hardcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">leafpad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">HC</span><span class="o">.</span><span class="n">TreeFigure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">relwidth</span><span class="o">=</span><span class="n">relwidth</span><span class="p">,</span> <span class="n">leafpad</span><span class="o">=</span><span class="n">leafpad</span><span class="p">,</span>
                          <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">support</span><span class="p">,</span>
                          <span class="n">leaf_fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">,</span>
                          <span class="n">branch_fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_fontsize</span><span class="p">,</span>
                          <span class="n">branch_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_width</span><span class="p">,</span>
                          <span class="n">branch_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_color</span><span class="p">,</span>
                          <span class="n">highlight_support</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span><span class="p">,</span>
                          <span class="n">branchlabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                          <span class="n">decorators</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">,</span>
                          <span class="n">leaflabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span>
                          <span class="n">ylim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">p</span>
</div>
<div class="viewcode-block" id="Tree.highlight"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">mrca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">mrca</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mrca</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="p">]:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">while</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">pcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                <span class="n">px</span> <span class="o">=</span> <span class="n">pcoords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">pcoords</span><span class="o">.</span><span class="n">y</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                    <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
                    <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
                    <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
                    <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">mrca</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="n">mrca</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">p</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">verts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">));</span> <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">highlightpath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlightpath</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.find"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find node(s) matching pattern s and zoom to node(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.zoom_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.zoom_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">();</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">);</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>

        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">[</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="p">]</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="n">Bbox</span><span class="p">(((</span><span class="n">xmin</span><span class="p">,</span><span class="n">ymin</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)))</span>

        <span class="c"># convert data coordinates to display coordinates</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">disp_bb</span> <span class="o">=</span> <span class="p">[</span><span class="n">Bbox</span><span class="p">(</span><span class="n">transform</span><span class="p">(</span><span class="n">bb</span><span class="p">))]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">txt</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                    <span class="n">disp_bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">())</span>

        <span class="n">disp_bb</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">disp_bb</span><span class="p">)</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>

        <span class="c"># convert back to data coordinates</span>
        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">disp_bb</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.zoom_clade"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.zoom_clade">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_clade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anc</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">anc</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_node</span><span class="p">(</span><span class="n">anc</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_nodes</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">anc</span><span class="p">),</span> <span class="n">border</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.draw_leaf_labels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.draw_leaf_labels">[docs]</a>    <span class="k">def</span> <span class="nf">draw_leaf_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isleaf</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">get_visible_nodes</span><span class="p">(</span><span class="n">labeled_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)))</span>
        <span class="n">psep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_pixelsep</span><span class="p">()</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">psep</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">n2l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
            <span class="n">n2l</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="c"># draw leaves</span>
        <span class="n">leaves_drawn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">leaves_drawn</span><span class="p">:</span>
                <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">leaves_drawn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="n">txt2</span> <span class="o">=</span> <span class="n">leaves_drawn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="n">transform</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="n">y0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">y1</span><span class="p">]))[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="n">fontsize</span><span class="p">:</span>
                <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">txt</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
                <span class="n">leaves_drawn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">leaves_drawn</span><span class="p">:</span>
            <span class="n">leaves_drawn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fontsize</span>
</div>
<div class="viewcode-block" id="Tree.draw_labels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.draw_labels">[docs]</a>    <span class="k">def</span> <span class="nf">draw_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_leaf_labels</span><span class="p">())</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible_nodes</span><span class="p">(</span><span class="n">labeled_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="c">## print [ x[0].id for x in nodes ]</span>
        <span class="n">branches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="ow">not</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isleaf</span><span class="p">),</span> <span class="n">nodes</span><span class="p">))</span>
        <span class="n">n2l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">n2l</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">t</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.unclutter"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.unclutter">[docs]</a>    <span class="k">def</span> <span class="nf">unclutter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible_nodes</span><span class="p">(</span><span class="n">labeled_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">branches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="ow">not</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isleaf</span><span class="p">),</span> <span class="n">nodes</span><span class="p">))</span>
        <span class="n">psep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_pixelsep</span><span class="p">()</span>
        <span class="n">n2l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span>
        <span class="n">fontsize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">psep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">))</span>

        <span class="n">drawn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">n2l</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bb</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">vis</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">for</span> <span class="n">n2</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">drawn</span><span class="p">):</span>
                    <span class="n">txt2</span> <span class="o">=</span> <span class="n">n2l</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">bb</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">txt2</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()):</span>
                        <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                        <span class="n">vis</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">vis</span><span class="p">:</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
                    <span class="n">drawn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="k">pass</span>
                <span class="c">## txt.set_visible(True)</span>
                <span class="c">## txt.set_size(fontsize)</span>
                <span class="c">## drawn.append(n)</span>
                <span class="c">## self.figure.canvas.draw_idle()</span>
</div>
<div class="viewcode-block" id="Tree.leaf_pixelsep"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.leaf_pixelsep">[docs]</a>    <span class="k">def</span> <span class="nf">leaf_pixelsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">display_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)))</span>
        <span class="c"># height in pixels (visible y data extent)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">display_points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">pixelsep</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_hsep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pixelsep</span>
</div>
<div class="viewcode-block" id="Tree.ypp"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.ypp">[docs]</a>    <span class="k">def</span> <span class="nf">ypp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)))[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="o">-</span><span class="n">p0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.draw_labels_old"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.draw_labels_old">[docs]</a>    <span class="k">def</span> <span class="nf">draw_labels_old</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span><span class="p">:</span>
            <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">);</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>

            <span class="n">display_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)))</span>
            <span class="c"># height in pixels (visible y data extent)</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">display_points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">pixelsep</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_hsep</span><span class="p">)</span>
            <span class="n">fontsize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">pixelsep</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="mi">12</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pixelsep</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">:</span>
                            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
                            <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">):</span>
                                <span class="n">txt</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
                                <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">:</span>
                            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
                            <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">):</span>
                                <span class="n">txt</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
                                <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pixelsep</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
                        <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">:</span>
                            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
                            <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">):</span>
                                <span class="n">txt</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
                                <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">home</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replot the tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">layout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;ylim_changed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.set_name"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.set_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">at</span> <span class="o">=</span> <span class="n">AnchoredText</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s">&quot;bold&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">at</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">at</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&quot;white&quot;</span><span class="p">)</span>
            <span class="n">at</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">at</span>
</div>
    <span class="k">def</span> <span class="nf">_path_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For use in drawing branches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">];</span> <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">];</span> <span class="n">px</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">y</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">)]</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">verts</span><span class="p">,</span> <span class="n">codes</span>
        <span class="c">## return [PathPatch(Path(verts, codes), fill=False,</span>
        <span class="c">##                   linewidth=width or self.branch_width,</span>
        <span class="c">##                   edgecolor=color or self.branch_color)]</span>


<div class="viewcode-block" id="Tree.layout"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.layout">[docs]</a>    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span> <span class="o">=</span> <span class="n">cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">yunit</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                             <span class="n">smooth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">smooth_xpos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xoff</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
            <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">sv</span><span class="c">#numpy.array(sv)</span>
        <span class="c">## n2c = self.n2c</span>
        <span class="c">## self.node2linesegs = {}</span>
        <span class="c">## for node, coords in n2c.items():</span>
        <span class="c">##     x = coords.x; y = coords.y</span>
        <span class="c">##     v = [(x,y)]</span>
        <span class="c">##     if node.parent:</span>
        <span class="c">##         pcoords = n2c[node.parent]</span>
        <span class="c">##         px = pcoords.x; py = pcoords.y</span>
        <span class="c">##         v.append((px,y))</span>
        <span class="c">##         v.append((px,py))</span>
        <span class="c">##         self.node2linesegs[node] = v</span>
</div>
<div class="viewcode-block" id="Tree.set_root"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.set_root">[docs]</a>    <span class="k">def</span> <span class="nf">set_root</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">leaves</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_hsep</span> <span class="o">=</span> <span class="mf">1.0</span><span class="c">#/float(self.nleaves)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">descendants</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="o">=</span><span class="bp">False</span><span class="p">;</span> <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.plot_tree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.plot_tree">[docs]</a>    <span class="k">def</span> <span class="nf">plot_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw branches and labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">root</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>

        <span class="k">if</span> <span class="s">&quot;branchlabels&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;branchlabels&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s">&quot;leaflabels&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;leaflabels&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_branch_artists</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_label_artists</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlight_support</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_highlight_support</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">()</span>
        <span class="c">## self.home()</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">decorators</span><span class="p">:</span>
            <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">leaves</span><span class="p">()</span> <span class="p">]</span>
        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot;&quot;</span>
            <span class="k">try</span><span class="p">:</span> <span class="k">return</span> <span class="n">labels</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span>
        <span class="c">#self.yaxis.set_major_formatter(FuncFormatter(fmt))</span>

        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="Tree.clade_dimensions"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.clade_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">clade_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">def</span> <span class="nf">recurse</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n2c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="n">recurse</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n2c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n2c</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">()</span>
                    <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
                <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
                <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">recurse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">n2c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>
</div>
<div class="viewcode-block" id="Tree.clade_height_pixels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.clade_height_pixels">[docs]</a>    <span class="k">def</span> <span class="nf">clade_height_pixels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ypp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ypp</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clade_dimensions</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="n">ypp</span>
        <span class="k">return</span> <span class="n">h</span>
</div>
    <span class="k">def</span> <span class="nf">_decimate_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span>
        <span class="n">nleaves</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nleaves</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nleaves</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span> <span class="n">leaves</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span> <span class="p">]</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rootpath</span><span class="p">())</span>
                                                  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">leaves</span> <span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>

<div class="viewcode-block" id="Tree.create_branch_artists"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.create_branch_artists">[docs]</a>    <span class="k">def</span> <span class="nf">create_branch_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use MPL Paths to draw branches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">## patches = []</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">descendants</span><span class="p">():</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_to_parent</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchpatch</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_width</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_color</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branchpatch</span><span class="p">)</span>
        <span class="c">## for node in self._decimate_nodes():</span>
        <span class="c">##     if node.parent:</span>
        <span class="c">##         for p in self._path_to_parent(node):</span>
        <span class="c">##             patches.append(p)</span>
        <span class="c">## self.branch_patches = PatchCollection(patches, match_original=True)</span>
        <span class="c">## self.add_collection(self.branch_patches)</span>

        <span class="c">## print &quot;enter: create_branch_artists&quot;</span>
        <span class="c">## self.node2branch = {}</span>
        <span class="c">## for node, segs in self.node2linesegs.items():</span>
        <span class="c">##     line = Line2D(</span>
        <span class="c">##         [x[0] for x in segs], [x[1] for x in segs],</span>
        <span class="c">##         lw=self.branch_width, color=self.branch_color</span>
        <span class="c">##         )</span>
        <span class="c">##     line.set_visible(False)</span>
        <span class="c">##     Axes.add_artist(self, line)</span>
        <span class="c">##     self.node2branch[node] = line</span>

        <span class="c">## d = self.node2linesegs</span>
        <span class="c">## segs = [ d[n] for n in self.root if (n in d) ]</span>

        <span class="c">## dims = self.clade_dimensions(); ypp = self.ypp()</span>
        <span class="c">## def recurse(n, dims, clades, terminals):</span>
        <span class="c">##     stop = False</span>
        <span class="c">##     h = None</span>
        <span class="c">##     v = dims.get(n)</span>
        <span class="c">##     if v: h = (v[3]-v[2])/ypp</span>
        <span class="c">##     if (h and (h &lt; 20)) or (not h):</span>
        <span class="c">##         stop = True</span>
        <span class="c">##         terminals.append(n)</span>
        <span class="c">##     if not stop:</span>
        <span class="c">##         clades.append(n)</span>
        <span class="c">##         for c in n.children:</span>
        <span class="c">##             recurse(c, dims, clades, terminals)</span>
        <span class="c">## clades = []; terminals = []</span>
        <span class="c">## recurse(self.root, dims, clades, terminals)</span>
        <span class="c">## segs = [ d[n] for n in self.root if (n in d) and (n in clades) ]</span>
        <span class="c">## for t in terminals:</span>
        <span class="c">##     if t.isleaf:</span>
        <span class="c">##         segs.append(d[t])</span>
        <span class="c">##     else:</span>
        <span class="c">##         x0, x1, y0, y1 = dims[t]</span>
        <span class="c">##         x, y = self.n2c[t].point()</span>
        <span class="c">##         px, py = self.n2c[t.parent].point()</span>
        <span class="c">##         segs.append(((px,py), (px,y), (x,y), (x1, y0), (x1,y1), (x,y)))</span>

        <span class="c">## lc = LineCollection(segs, linewidths=self.branch_width,</span>
        <span class="c">##                     colors = self.branch_color)</span>
        <span class="c">## self.branches_linecollection = Axes.add_collection(self, lc)</span>
        <span class="c">## print &quot;leave: create_branch_artists&quot;</span>
</div>
<div class="viewcode-block" id="Tree.create_label_artists"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.create_label_artists">[docs]</a>    <span class="k">def</span> <span class="nf">create_label_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">## print &quot;enter: create_label_artists&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">isleaf</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">textcoords</span><span class="o">=</span><span class="s">&quot;offset points&quot;</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_valign</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_halign</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">,</span>
                    <span class="n">clip_on</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">picker</span><span class="o">=</span><span class="bp">True</span>
                <span class="p">)</span>
                <span class="n">txt</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>
                <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">txt</span>

            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">isleaf</span><span class="p">)</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_offset</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
                    <span class="n">textcoords</span><span class="o">=</span><span class="s">&quot;offset points&quot;</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_valign</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_halign</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_fontsize</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="s">&quot;lightyellow&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>
                    <span class="n">clip_on</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">picker</span><span class="o">=</span><span class="bp">True</span>
                <span class="p">)</span>
                <span class="c">## txt.set_visible(False)</span>
                <span class="n">txt</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">txt</span>
        <span class="c">## print &quot;leave: create_label_artists&quot;</span>
</div>
<div class="viewcode-block" id="Tree.adjust_xspine"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.adjust_xspine">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_xspine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">iter_ticks</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">t</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.mark_named"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.mark_named">[docs]</a>    <span class="k">def</span> <span class="nf">mark_named</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mark_named</span><span class="p">:</span>
            <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">isleaf</span><span class="p">)</span> <span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cv</span> <span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cv</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                      <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="p">]</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                    <span class="n">xmax</span> <span class="o">=</span> <span class="n">trans</span><span class="p">((</span><span class="nb">max</span><span class="p">([</span> <span class="n">x</span><span class="o">.</span><span class="n">xmax</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]),</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">xmin</span> <span class="o">=</span> <span class="n">trans</span><span class="p">((</span><span class="nb">min</span><span class="p">([</span> <span class="n">x</span><span class="o">.</span><span class="n">xmin</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]),</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">;</span> <span class="n">xpad</span> <span class="o">=</span> <span class="n">xspan</span><span class="o">*</span><span class="mf">0.05</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">;</span> <span class="n">ypad</span> <span class="o">=</span> <span class="n">yspan</span><span class="o">*</span><span class="mf">0.05</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">-</span><span class="n">xpad</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="n">xpad</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">-</span><span class="n">ypad</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="n">ypad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.scroll"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.scroll">[docs]</a>    <span class="k">def</span> <span class="nf">scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">xd</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
        <span class="n">yd</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">xd</span><span class="p">,</span> <span class="n">x1</span><span class="o">+</span><span class="n">xd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">yd</span><span class="p">,</span> <span class="n">y1</span><span class="o">+</span><span class="n">yd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.plot_labelcolor"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.plot_labelcolor">[docs]</a>    <span class="k">def</span> <span class="nf">plot_labelcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodemap</span><span class="p">,</span> <span class="n">state2color</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">state2color</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">tango</span><span class="p">()</span>
            <span class="n">states</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">nodemap</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">state2color</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">nodemap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">state2color</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.node_image"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.node_image">[docs]</a>    <span class="k">def</span> <span class="nf">node_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">imgfile</span><span class="p">,</span> <span class="n">maxdim</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_offset</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="n">node</span><span class="p">];</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imgfile</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxdim</span><span class="p">:</span>
            <span class="n">img</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">((</span><span class="n">maxdim</span><span class="p">,</span> <span class="n">maxdim</span><span class="p">))</span>
        <span class="n">imgbox</span> <span class="o">=</span> <span class="n">OffsetImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">xycoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="ow">or</span> <span class="s">&quot;data&quot;</span>
        <span class="k">if</span> <span class="n">xycoords</span> <span class="o">!=</span> <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">abox</span> <span class="o">=</span> <span class="n">AnnotationBbox</span><span class="p">(</span><span class="n">imgbox</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span>
                              <span class="n">xybox</span><span class="o">=</span><span class="p">(</span><span class="n">xoff</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                              <span class="n">xycoords</span><span class="o">=</span><span class="n">xycoords</span><span class="p">,</span>
                              <span class="n">box_alignment</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
                              <span class="n">pad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                              <span class="n">boxcoords</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;offset points&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">abox</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.plot_discrete"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.plot_discrete">[docs]</a>    <span class="k">def</span> <span class="nf">plot_discrete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">xoff</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">ivy</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">tango</span><span class="p">()</span>
            <span class="n">states</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">points</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">root</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">])</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">y</span><span class="p">));</span> <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmap</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>

        <span class="n">boxes</span> <span class="o">=</span> <span class="n">symbols</span><span class="o">.</span><span class="n">squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">handles</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="n">c</span><span class="p">))</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">boxes</span>
</div>
<div class="viewcode-block" id="Tree.plot_continuous"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Tree.plot_continuous">[docs]</a>    <span class="k">def</span> <span class="nf">plot_continuous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">);</span> <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmin</span><span class="o">+</span><span class="n">vmax</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">mid</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vmin</span><span class="o">-</span><span class="n">mid</span><span class="p">))</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl_colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mid</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
        <span class="c">## if cmap is None: cmap = mpl_colormap.binary</span>
        <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl_colormap</span><span class="o">.</span><span class="n">hot</span>
        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span> <span class="p">(</span><span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n2c</span> <span class="p">]</span>
            <span class="p">)</span>
        <span class="n">circles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">1000</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">circles</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="RadialTree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.RadialTree">[docs]</a><span class="k">class</span> <span class="nc">RadialTree</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
<div class="viewcode-block" id="RadialTree.layout"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.RadialTree.layout">[docs]</a>    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">..layout_polar</span> <span class="kn">import</span> <span class="n">calc_node_positions</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;start&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;end&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span> <span class="o">=</span> <span class="n">calc_node_positions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span>
                                       <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
            <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">sv</span>

    <span class="c">## def _path_to_parent(self, node, width=None, color=None):</span>
    <span class="c">##     c = self.n2c[node]; theta1 = c.angle; r = c.depth</span>
    <span class="c">##     M = Path.MOVETO; L = Path.LINETO</span>
    <span class="c">##     pc = self.n2c[node.parent]; theta2 = pc.angle</span>
    <span class="c">##     px1 = math.cos(math.radians(c.angle))*pc.depth</span>
    <span class="c">##     py1 = math.sin(math.radians(c.angle))*pc.depth</span>
    <span class="c">##     verts = [(c.x,c.y),(px1,py1)]; codes = [M,L]</span>
    <span class="c">##     #verts.append((pc.x,pc.y)); codes.append(L)</span>
    <span class="c">##     path = PathPatch(Path(verts, codes), fill=False,</span>
    <span class="c">##                      linewidth=width or self.branch_width,</span>
    <span class="c">##                      edgecolor=color or self.branch_color)</span>
    <span class="c">##     diam = pc.depth*2</span>
    <span class="c">##     t1, t2 = tuple(sorted((theta1,theta2)))</span>
    <span class="c">##     arc = Arc((0,0), diam, diam, theta1=t1, theta2=t2,</span>
    <span class="c">##               edgecolor=color or self.branch_color,</span>
    <span class="c">##               linewidth=width or self.branch_width)</span>
    <span class="c">##     return [path, arc]</span>
</div>
    <span class="k">def</span> <span class="nf">_path_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">];</span> <span class="n">theta1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">];</span> <span class="n">theta2</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">angle</span>
        <span class="n">px1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">py1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">px1</span><span class="p">,</span><span class="n">py1</span><span class="p">)];</span> <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="n">L</span><span class="p">]</span>
        <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">((</span><span class="n">theta1</span><span class="p">,</span><span class="n">theta2</span><span class="p">)))</span>
        <span class="n">diam</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">depth</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">arc</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">diam</span><span class="p">,</span> <span class="n">diam</span><span class="p">,</span> <span class="n">theta1</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="n">t2</span><span class="p">)</span>
        <span class="n">arcpath</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>
        <span class="n">av</span> <span class="o">=</span> <span class="n">arcpath</span><span class="o">.</span><span class="n">vertices</span> <span class="o">*</span> <span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="n">arcpath</span><span class="o">.</span><span class="n">codes</span>
        <span class="n">verts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">verts</span><span class="p">,</span> <span class="n">codes</span>

<div class="viewcode-block" id="RadialTree.highlight"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.RadialTree.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">mrca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mrca</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">mrca</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mrca</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="p">]:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
            <span class="k">while</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">pcoords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                <span class="n">px</span> <span class="o">=</span> <span class="n">pcoords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">pcoords</span><span class="o">.</span><span class="n">y</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_to_parent</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="n">verts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                    <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">mrca</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="n">mrca</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">p</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
        <span class="c">## px, py = verts[-1]</span>
        <span class="c">## verts.append((px, py)); codes.append(M)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlightpath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlightpath</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highlightpatch</span><span class="p">)</span>
        <span class="c">## self.highlight_patches = PatchCollection(patches, match_original=True)</span>
        <span class="c">## self.add_collection(self.highlight_patches)</span>

</div></div>
<div class="viewcode-block" id="OverviewTree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.OverviewTree">[docs]</a><span class="k">class</span> <span class="nc">OverviewTree</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;leaflabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;branchlabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">Tree</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_overview_rect</span><span class="p">()</span>

<div class="viewcode-block" id="OverviewTree.set_target"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.OverviewTree.set_target">[docs]</a>    <span class="k">def</span> <span class="nf">set_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>
</div>
<div class="viewcode-block" id="OverviewTree.add_overview_rect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.OverviewTree.add_overview_rect">[docs]</a>    <span class="k">def</span> <span class="nf">add_overview_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">UpdatingRect</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomrect</span> <span class="o">=</span> <span class="n">rect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="c">## if pyplot.isinteractive():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;xlim_changed&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;ylim_changed&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OverviewTree.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.OverviewTree.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Tree</span><span class="o">.</span><span class="n">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_overview_rect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div></div>
<div class="viewcode-block" id="axes_enter"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.axes_enter">[docs]</a><span class="k">def</span> <span class="nf">axes_enter</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">_active</span> <span class="o">=</span> <span class="bp">True</span>
</div>
<div class="viewcode-block" id="axes_leave"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.axes_leave">[docs]</a><span class="k">def</span> <span class="nf">axes_leave</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">_active</span> <span class="o">=</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="onselect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.onselect">[docs]</a><span class="k">def</span> <span class="nf">onselect</span><span class="p">(</span><span class="n">estart</span><span class="p">,</span> <span class="n">estop</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">estart</span><span class="o">.</span><span class="n">button</span>
    <span class="c">## print b, estart.key</span>
</div>
<div class="viewcode-block" id="onkeypress"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.onkeypress">[docs]</a><span class="k">def</span> <span class="nf">onkeypress</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">key</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;t&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;down&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;up&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;right&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="s">&#39;=+&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ondrag"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.ondrag">[docs]</a><span class="k">def</span> <span class="nf">ondrag</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="n">button</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">button</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="o">.</span><span class="n">pan_start</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">pan_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pan_start</span>
        <span class="n">xdelta</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">e</span><span class="o">.</span><span class="n">xdata</span>
        <span class="n">ydelta</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="n">x1</span><span class="o">-</span><span class="n">x0</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
        <span class="n">midx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">midy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">midx</span><span class="o">+</span><span class="n">xdelta</span><span class="o">-</span><span class="n">xspan</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">midx</span><span class="o">+</span><span class="n">xdelta</span><span class="o">+</span><span class="n">xspan</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">midy</span><span class="o">+</span><span class="n">ydelta</span><span class="o">-</span><span class="n">yspan</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">midy</span><span class="o">+</span><span class="n">ydelta</span><span class="o">+</span><span class="n">yspan</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="onbuttonrelease"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.onbuttonrelease">[docs]</a><span class="k">def</span> <span class="nf">onbuttonrelease</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="n">button</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span>
    <span class="k">if</span> <span class="n">button</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c">## print &quot;pan end&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">pan_start</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="onpick"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.onpick">[docs]</a><span class="k">def</span> <span class="nf">onpick</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="k">if</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">picked</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="onscroll"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.onscroll">[docs]</a><span class="k">def</span> <span class="nf">onscroll</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="k">if</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span>
        <span class="c">## print b</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">key</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span><span class="s">&quot;up&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span><span class="s">&quot;down&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;shift&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;up&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">zoom_cxy</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;shift&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;down&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">zoom_cxy</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;control&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;up&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">zoom_cxy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;control&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;down&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">zoom_cxy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;d&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;up&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="s">&quot;d&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;down&quot;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;c&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;up&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s">&quot;c&quot;</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&quot;down&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scroll</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="onclick"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.onclick">[docs]</a><span class="k">def</span> <span class="nf">onclick</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">inaxes</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s">&quot;zoomrect&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ax</span><span class="o">.</span><span class="n">zoomrect</span><span class="p">:</span>
        <span class="c"># overview clicked; reposition zoomrect</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">zoomrect</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">xdata</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">get_extents</span><span class="p">())</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">yoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xoff</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="n">xoff</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yoff</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">yoff</span><span class="p">)</span>
        <span class="n">r</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="c">## print &quot;pan start&quot;, (e.xdata, e.ydata)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">pan_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="test_decorate"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.test_decorate">[docs]</a><span class="k">def</span> <span class="nf">test_decorate</span><span class="p">(</span><span class="n">treeplot</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">evolve</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">evolve</span><span class="o">.</span><span class="n">brownian</span><span class="p">(</span><span class="n">treeplot</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">);</span> <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl_colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl_colormap</span><span class="o">.</span><span class="n">binary</span>
    <span class="n">n2c</span> <span class="o">=</span> <span class="n">treeplot</span><span class="o">.</span><span class="n">n2c</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span> <span class="p">(</span><span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n2c</span> <span class="p">]</span>
        <span class="p">)</span>
    <span class="n">circles</span> <span class="o">=</span> <span class="n">treeplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span>
        <span class="p">)</span>
</div>
<div class="viewcode-block" id="Decorator"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.Decorator">[docs]</a><span class="k">class</span> <span class="nc">Decorator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treeplot</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">treeplot</span>
</div>
<div class="viewcode-block" id="VisToggle"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.VisToggle">[docs]</a><span class="k">class</span> <span class="nc">VisToggle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">treeplot</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">treeplot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="VisToggle.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.VisToggle.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="VisToggle.toggle"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.VisToggle.toggle">[docs]</a>    <span class="k">def</span> <span class="nf">toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="VisToggle.show"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.VisToggle.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="VisToggle.hide"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.tree.VisToggle.hide">[docs]</a>    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>

</div></div>
<span class="n">TreePlot</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">Tree</span><span class="p">)</span>
<span class="n">RadialTreePlot</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">RadialTree</span><span class="p">)</span>
<span class="n">OverviewTreePlot</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">OverviewTree</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">evolve</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">evolve</span><span class="o">.</span><span class="n">test_brownian</span><span class="p">()</span>
    <span class="n">plot_continuous</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;Brownian&quot;</span><span class="p">,</span> <span class="n">mid</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">ivy 0.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, RR, CZ.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>