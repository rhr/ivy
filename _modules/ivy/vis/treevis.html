<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ivy.vis.treevis &mdash; ivy 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="ivy 0.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">ivy 0.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ivy.vis.treevis</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">interactive viewers for trees, etc. using matplotlib</span>

<span class="sd">Re-written to have a layer-based API</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">bisect</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">types</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">operator</span><span class="o">,</span> <span class="nn">functools</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">ivy</span> <span class="kn">import</span> <span class="n">tree</span><span class="p">,</span> <span class="n">bipart</span>
<span class="kn">from</span> <span class="nn">ivy.layout</span> <span class="kn">import</span> <span class="n">cartesian</span>
<span class="kn">from</span> <span class="nn">ivy.storage</span> <span class="kn">import</span> <span class="n">Storage</span>
<span class="kn">from</span> <span class="nn">ivy</span> <span class="kn">import</span> <span class="n">pyperclip</span> <span class="k">as</span> <span class="n">clipboard</span>
<span class="c">#from ..nodecache import NodeCache</span>
<span class="kn">import</span> <span class="nn">matplotlib</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">SubplotParams</span><span class="p">,</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.axes</span> <span class="kn">import</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">subplot_class_factory</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">PathPatch</span><span class="p">,</span> <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Arc</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">RectangleSelector</span>
<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">offset_copy</span><span class="p">,</span> <span class="n">IdentityTransform</span><span class="p">,</span> \
     <span class="n">Affine2D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span> <span class="k">as</span> <span class="n">mpl_colormap</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">mpl_colors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">import</span> <span class="n">Colorbar</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">RegularPolyCollection</span><span class="p">,</span> <span class="n">LineCollection</span><span class="p">,</span> \
     <span class="n">PatchCollection</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">OffsetImage</span><span class="p">,</span> <span class="n">AnnotationBbox</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="kn">from</span> <span class="nn">matplotlib._png</span> <span class="kn">import</span> <span class="n">read_png</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span><span class="p">,</span> <span class="n">FuncFormatter</span><span class="p">,</span> <span class="n">NullLocator</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid.anchored_artists</span> <span class="kn">import</span> <span class="n">AnchoredText</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="kn">from</span> <span class="nn">ivy.vis</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">ivy.vis</span> <span class="kn">import</span> <span class="n">hardcopy</span> <span class="k">as</span> <span class="n">HC</span>
<span class="kn">from</span> <span class="nn">ivy.vis</span> <span class="kn">import</span> <span class="n">events</span><span class="p">,</span> <span class="n">layers</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">Image</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">_tango</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">tango</span><span class="p">()</span>
<div class="viewcode-block" id="TreeFigure"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure">[docs]</a><span class="k">class</span> <span class="nc">TreeFigure</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    mpl Figure for plotting trees.</span>

<span class="sd">    Holds references to all layers:</span>
<span class="sd">        - Tree (the base layer: the Axes which all other layers are drawn on)</span>
<span class="sd">        - Node labels</span>
<span class="sd">        - Tip labels</span>
<span class="sd">        - Overview</span>
<span class="sd">        - Decorators</span>
<span class="sd">        - Etc.</span>

<span class="sd">        The navigation toolbar at the bottom is provided by matplotlib</span>
<span class="sd">    (http://matplotlib.sf.net/users/navigation_toolbar.html).  Its</span>
<span class="sd">    pan/zoom button and zoom-rectangle button provide different modes</span>
<span class="sd">    of mouse interaction with the figure.  When neither of these</span>
<span class="sd">    buttons are checked, the default mouse bindings are as follows:</span>

<span class="sd">    * button 1 drag: select nodes - retrieve by calling fig.selected</span>
<span class="sd">    * button 3 drag: pan view</span>
<span class="sd">    * scroll up/down: zoom in/out</span>
<span class="sd">    * scroll up/down with Control key: zoom y-axis</span>
<span class="sd">    * scroll up/down with Shift key: zoom x-axis</span>
<span class="sd">    * scroll up/down with &#39;d&#39; key: pan view up/down</span>
<span class="sd">    * scroll up/down with &#39;e&#39; key: pan view left/right</span>
<span class="sd">    * click on overview will center the detail pane on that region</span>

<span class="sd">    Default keybindings:</span>

<span class="sd">    * t: zoom out to full extent</span>
<span class="sd">    * +/-: zoom in/out</span>

<span class="sd">    Useful attributes and methods (assume an instance named *fig*):</span>

<span class="sd">    * fig.root - the root node (see [Node methods])</span>
<span class="sd">    * fig.highlight(s) - highlight and trace nodes with substring *s*</span>
<span class="sd">    * fig.zoom_clade(anc) - zoom to view node *anc* and all its descendants</span>
<span class="sd">    * fig.toggle_overview() - toggle visibility of the overview pane</span>
<span class="sd">    * fig.toggle_branchlabels() - ditto for branch labels</span>
<span class="sd">    * fig.toggle_leaflabels() - ditto for leaf labels</span>
<span class="sd">    * fig.decorate(func) - decorate the tree with a function (see</span>
<span class="sd">      :ref:`decorating TreeFigures &lt;decorating-trees&gt;`)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">div</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                 <span class="n">branchlabels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">xoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">mark_named</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">overview</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">radial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaf_fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">branch_fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">direction</span><span class="o">=</span><span class="s">&quot;rightwards&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overview</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="n">div</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radial</span> <span class="o">=</span> <span class="n">radial</span>
        <span class="k">if</span> <span class="n">radial</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">branchlabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="n">leaflabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xoff</span> <span class="o">=</span> <span class="n">xoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span> <span class="o">=</span> <span class="n">yoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="o">=</span><span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span> <span class="o">=</span> <span class="s">&quot;left&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span> <span class="k">else</span> <span class="s">&quot;right&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_anchor</span> <span class="o">=</span> <span class="s">&quot;right&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span> <span class="k">else</span> <span class="s">&quot;left&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="o">=</span><span class="n">mark_named</span> <span class="c"># Drawing a circle at named nodes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">&quot;cannot coerce data into tree.Node&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="n">root</span><span class="o">.</span><span class="n">treename</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">SubplotParams</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.01</span>
            <span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">subplotpars</span><span class="o">=</span><span class="n">pars</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">)</span>
        <span class="n">events</span><span class="o">.</span><span class="n">connect_events</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_subplots</span><span class="p">(</span><span class="n">overview</span><span class="p">,</span> <span class="n">leaf_fontsize</span><span class="p">,</span> <span class="n">branch_fontsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="c">#if self.tree.interactive:</span>
        <span class="c">#    self.figure.canvas.callbacks.connect(&quot;scroll_event&quot;, self.redraw(True))</span>

<div class="viewcode-block" id="TreeFigure.initialize_subplots"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.initialize_subplots">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_subplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overview</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">leaf_fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">branch_fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize treeplot (a matplotlib.axes.Axes) and add it to the figure.</span>
<span class="sd">        Also initialize overview. If overview=False, toggle off overview.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">radial</span><span class="p">:</span>
            <span class="n">tp</span> <span class="o">=</span> <span class="n">TreePlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">mark_named</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">,</span> <span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">plottype</span><span class="o">=</span><span class="s">&quot;phylogram&quot;</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                      <span class="n">branchlabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                      <span class="n">leaf_fontsize</span><span class="o">=</span><span class="n">leaf_fontsize</span><span class="p">,</span>
                      <span class="n">branch_fontsize</span><span class="o">=</span><span class="n">branch_fontsize</span><span class="p">,</span>
                      <span class="n">direction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_label</span><span class="p">,</span> <span class="s">&quot;leaf&quot;</span><span class="p">,</span> <span class="n">store</span> <span class="o">=</span> <span class="s">&quot;leaflabels&quot;</span><span class="p">,</span>
                           <span class="n">ov</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                           <span class="n">fontsize</span><span class="o">=</span><span class="n">leaf_fontsize</span><span class="p">,</span> <span class="n">leaf_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span><span class="p">,</span>
                           <span class="n">branch_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branch_anchor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_label</span><span class="p">,</span> <span class="s">&quot;branch&quot;</span><span class="p">,</span> <span class="n">store</span> <span class="o">=</span> <span class="s">&quot;branchlabels&quot;</span><span class="p">,</span>
                           <span class="n">ov</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                           <span class="n">fontsize</span><span class="o">=</span><span class="n">branch_fontsize</span><span class="p">,</span> <span class="n">leaf_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span><span class="p">,</span>
                           <span class="n">branch_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branch_anchor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="n">tp</span> <span class="o">=</span> <span class="n">RadialTreePlot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">mark_named</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">,</span>
                                <span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">plottype</span><span class="o">=</span><span class="s">&quot;radial&quot;</span><span class="p">,</span>
                                <span class="n">leaflabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                                <span class="n">branchlabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">)</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_label</span><span class="p">,</span> <span class="s">&quot;leaf&quot;</span><span class="p">,</span> <span class="n">store</span> <span class="o">=</span> <span class="s">&quot;leaflabels&quot;</span><span class="p">,</span>
                           <span class="n">ov</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                           <span class="n">fontsize</span><span class="o">=</span><span class="n">leaf_fontsize</span><span class="p">,</span> <span class="n">leaf_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span><span class="p">,</span>
                           <span class="n">branch_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branch_anchor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_label</span><span class="p">,</span> <span class="s">&quot;branch&quot;</span><span class="p">,</span> <span class="n">store</span> <span class="o">=</span> <span class="s">&quot;branchlabels&quot;</span><span class="p">,</span>
                           <span class="n">ov</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">vis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                           <span class="n">fontsize</span><span class="o">=</span><span class="n">branch_fontsize</span><span class="p">,</span> <span class="n">leaf_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span><span class="p">,</span>
                           <span class="n">branch_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branch_anchor</span><span class="p">)</span>
            <span class="n">overview</span><span class="o">=</span><span class="bp">False</span> <span class="c"># No support for overview for radial trees (yet?)</span>
        <span class="n">tp</span> <span class="o">=</span> <span class="n">OverviewTreePlot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span>
            <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">mark_named</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">,</span>
            <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
        <span class="n">ov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
        <span class="n">ov</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="n">ov</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overview</span> <span class="o">=</span> <span class="n">ov</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">overview</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_overview</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">nleaves</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_overview</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span></div>
    <span class="k">def</span> <span class="nf">__get_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">selected_nodes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__set_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__del_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="n">selected</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">__get_selected_nodes</span><span class="p">,</span>
                        <span class="n">__set_selected_nodes</span><span class="p">,</span>
                        <span class="n">__del_selected_nodes</span><span class="p">)</span>

<div class="viewcode-block" id="TreeFigure.on_nodes_selected"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.on_nodes_selected">[docs]</a>    <span class="k">def</span> <span class="nf">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treeplot</span><span class="p">):</span>
        <span class="k">pass</span></div>
<div class="viewcode-block" id="TreeFigure.select_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.select_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">select_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select nodes on the plot</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes: A node or list of ndoes</span>
<span class="sd">        Notes:</span>
<span class="sd">            If only one node is given, all of the node&#39;s ancestors are</span>
<span class="sd">            also selected. If a list of nodes is given (even if it has only</span>
<span class="sd">            one node), only the given node(s) are selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>

<div class="viewcode-block" id="TreeFigure.picked"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.picked">[docs]</a>    <span class="k">def</span> <span class="nf">picked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">button</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
                <span class="n">clipboard</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="TreeFigure.ladderize"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.ladderize">[docs]</a>    <span class="k">def</span> <span class="nf">ladderize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rev</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ladderize and redraw the tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">ladderize</span><span class="p">(</span><span class="n">rev</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.show"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the figure in a new window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.set_positions"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.set_positions">[docs]</a>    <span class="k">def</span> <span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">if</span> <span class="n">ov</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span><span class="p">:</span>
                <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;leftwards&quot;</span><span class="p">:</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span>
            <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span><span class="p">,</span> <span class="n">height</span><span class="p">]</span>
            <span class="n">ov</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">xoffset</span><span class="p">(),</span> <span class="n">w</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span></div>
<div class="viewcode-block" id="TreeFigure.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keeptemp</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replot the figure and overview</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keeptemp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;temp&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">lay</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">lay</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="s">&quot;vis&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">lay</span><span class="p">]()</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">keeptemp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;temp&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lay</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span><span class="p">[</span><span class="n">lay</span><span class="p">]()</span>
                <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="TreeFigure.find"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find nodes</span>

<span class="sd">        Args:</span>
<span class="sd">            x (str): String to search</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: A list of node objects found with the Node findall() method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return plot to initial size and location.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.zoom_clade"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.zoom_clade">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_clade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom to fit a node *x* and all its descendants in the view.</span>

<span class="sd">        Args:</span>
<span class="sd">            x: Node or str that matches the label of a node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">zoom_clade</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TreeFigure.zoom"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.zoom">[docs]</a>    <span class="k">def</span> <span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zoom both axes by *factor* (relative display size).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.zx"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.zx">[docs]</a>    <span class="k">def</span> <span class="nf">zx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zoom x axis by *factor*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TreeFigure.zy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.zy">[docs]</a>    <span class="k">def</span> <span class="nf">zy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Zoom y axis by *factor*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.toggle_overview"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.toggle_overview">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_overview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle overview</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="mf">0.001</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="k">elif</span> <span class="n">val</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">()</span></div>
<div class="viewcode-block" id="TreeFigure.hardcopy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.hardcopy">[docs]</a>    <span class="k">def</span> <span class="nf">hardcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">relwidth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">leafpad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">relwidth</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">())</span>
            <span class="n">relwidth</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">hardcopy</span><span class="p">(</span>
            <span class="n">relwidth</span><span class="o">=</span><span class="n">relwidth</span><span class="p">,</span>
            <span class="n">leafpad</span><span class="o">=</span><span class="n">leafpad</span>
            <span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="c">#f.axes.set_xlim(*self.detail.get_xlim())</span>
        <span class="c">#f.axes.set_ylim(*self.detail.get_ylim())</span>
        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span>
    <span class="c">##################################</span>
    <span class="c"># Layer API</span>
    <span class="c">##################################</span></div>
<div class="viewcode-block" id="TreeFigure.add_layer"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.add_layer">[docs]</a>    <span class="k">def</span> <span class="nf">add_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a new layer. New layers include:</span>

<span class="sd">        - Labels</span>
<span class="sd">        - Overview</span>
<span class="sd">        - Dataplot</span>
<span class="sd">        - Decorations</span>


<span class="sd">        Args:</span>
<span class="sd">            func (function): Function that takes a TreePlot (self.tree)</span>
<span class="sd">              as input and returns (and draws) an Artist</span>
<span class="sd">        Keyword Args:</span>
<span class="sd">            store (str): Name of layer. If given, the layer is stored in</span>
<span class="sd">              self.layers and called upon every redraw</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;store&quot;</span><span class="p">,</span> <span class="s">&quot;temp&quot;</span><span class="p">)</span> <span class="c"># Storing the plot to be redrawn</span>
        <span class="n">vis</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;vis&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="c"># Is the layer visible?</span>
        <span class="n">ov</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;ov&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="c"># Show the layer on the overview</span>
        <span class="c"># Using functools to store</span>
        <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">,</span>
                                            <span class="n">vis</span><span class="o">=</span><span class="n">vis</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ov</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview_width</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span> <span class="c"># Hackish way to check if overview is on</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">,</span>
                                                  <span class="n">vis</span><span class="o">=</span><span class="n">vis</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.remove_layer"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.remove_layer">[docs]</a>    <span class="k">def</span> <span class="nf">remove_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layername</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove a layer by name.</span>

<span class="sd">        Args:</span>
<span class="sd">            layername (str): Name of the layer to remove. See all layers</span>
<span class="sd">              with self.layers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">layername</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span><span class="p">[</span><span class="n">layername</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span></div>
<div class="viewcode-block" id="TreeFigure.toggle_layer"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.toggle_layer">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layername</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a layer to be visible/invisible (but still stored in self.layers)</span>

<span class="sd">        Args:</span>
<span class="sd">            layername (str): Name of the layer to toggle. See all layers with</span>
<span class="sd">              self.layers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">vis</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">layername</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="s">&quot;vis&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vis</span> <span class="o">=</span> <span class="n">val</span>
            <span class="c"># Functools allows previously-defined arguments to be overwritten</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">layername</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="s">&quot;vis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">overview</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ovlayers</span><span class="p">[</span><span class="n">layername</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="s">&quot;vis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vis</span>
            <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">(</span><span class="n">keeptemp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.reorder_layers"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.reorder_layers">[docs]</a>    <span class="k">def</span> <span class="nf">reorder_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neworder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reorder layers and redraw figure</span>

<span class="sd">        Args:</span>
<span class="sd">          neworder (list): New order of layers. Must include all layers</span>
<span class="sd">            currently in the figure. See all layers with `fig.layers`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">neworder</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>\
          <span class="s">&quot;Must specify order of all layers&quot;</span>

        <span class="n">new</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">neworder</span><span class="p">:</span>
            <span class="n">new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">redraw</span><span class="p">(</span><span class="n">keeptemp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


    <span class="c">############################</span>
    <span class="c"># Convenience functions</span>
    <span class="c">############################</span>
</div>
<div class="viewcode-block" id="TreeFigure.toggle_branchlabels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.toggle_branchlabels">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_branchlabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle visibility of branchlabels</span>
<span class="sd">        (equivalent to toggle_layer(&quot;branchlabels&quot;))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle_layer</span><span class="p">(</span><span class="s">&quot;branchlabels&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.toggle_leaflabels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.toggle_leaflabels">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_leaflabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggle visibility of leafabels</span>
<span class="sd">        (equivalent to self.toggle_layer(&quot;leaflabels&quot;))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle_layer</span><span class="p">(</span><span class="s">&quot;leaflabels&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.highlight"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience function for highlighting nodes</span>

<span class="sd">        Args:</span>
<span class="sd">            x: Str or list of Strs or Node or list of Nodes</span>
<span class="sd">            width (float): Width of highlighted lines. Defaults to 5</span>
<span class="sd">            color (str): Color of highlighted lines. Defaults to red</span>
<span class="sd">            vis (bool): Whether or not the object is visible. Defaults to true</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_highlight</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.cbar"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.cbar">[docs]</a>    <span class="k">def</span> <span class="nf">cbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience function for adding clade bar along y axis</span>

<span class="sd">        Draw a &#39;clade&#39; bar (i.e., along the y-axis) indicating a</span>
<span class="sd">        clade.  *nodes* are assumed to be one or more nodes in the</span>
<span class="sd">        tree.  If just one, it should be the internal node</span>
<span class="sd">        representing the clade of interest; otherwise, the clade of</span>
<span class="sd">        interest is the most recent common ancestor of the specified</span>
<span class="sd">        nodes.  *label* is an optional string to be drawn next to the</span>
<span class="sd">        bar, *offset* by the specified number of display units.  If</span>
<span class="sd">        *label* is ``None`` then the clade&#39;s label is used instead.</span>

<span class="sd">        Args:</span>
<span class="sd">            nodes: Node or list of nodes or string or list of strings.</span>
<span class="sd">            color (str): Color of the bar. Optional, defaults to None.</span>
<span class="sd">              If None, will cycle through a color palette</span>
<span class="sd">            label (str): Optional label for bar. If None, the clade&#39;s</span>
<span class="sd">              label is used instead. Defaults to None.</span>
<span class="sd">            width (float): Width of bar</span>
<span class="sd">            xoff (float): Offset from label to bar</span>
<span class="sd">            showlabel (bool): Whether or not to draw the label</span>
<span class="sd">            mrca (bool): Whether to draw the bar encompassing all descendants</span>
<span class="sd">              of the MRCA of ``nodes``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_cbar</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
<div class="viewcode-block" id="TreeFigure.tipstates"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.TreeFigure.tipstates">[docs]</a>    <span class="k">def</span> <span class="nf">tipstates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience function for drawing color-coded circles at tips indicating</span>
<span class="sd">        character states.</span>

<span class="sd">        Args:</span>
<span class="sd">            chars (dict): Dict mapping character states to tip labels.</span>
<span class="sd">              Character states should be coded 0,1,2...</span>

<span class="sd">              Can also be a list with tip states in preorder sequence</span>
<span class="sd">            nodes (list): List of nodes or node labels. Optional, defaults</span>
<span class="sd">              to all tip labels in preorder sequence</span>
<span class="sd">            colors (list): List of strs of the same length as the number</span>
<span class="sd">              of unique characters. Optional, defaults to tango colorscheme</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">add_tipstates</span><span class="p">,</span><span class="n">chars</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="Tree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree">[docs]</a><span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">Axes</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass for rendering trees</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">tf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tf</span> <span class="o">=</span> <span class="n">tf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;plottype&quot;</span><span class="p">,</span> <span class="s">&quot;phylogram&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;app&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">support</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;support&quot;</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;scaled&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mark_named</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;mark_named&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;leaf_fontsize&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branch_fontsize&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branch_width&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branch_color&quot;</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;interactive&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;leaflabels&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;branchlabels&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;direction&quot;</span><span class="p">,</span> <span class="s">&quot;rightwards&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span> <span class="o">=</span> <span class="s">&quot;left&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span> <span class="k">else</span> <span class="s">&quot;right&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branch_anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_anchor</span>
        <span class="c">## if self.decorators:</span>
        <span class="c">##     print &gt;&gt; sys.stderr, &quot;got %s decorators&quot; % len(self.decorators)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xoff</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;xoff&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;yoff&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smooth_xpos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&quot;smooth_xpos&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">Axes</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pan_start</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="n">RectangleSelector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rectselect</span><span class="p">,</span>
                                          <span class="n">useblit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_active</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">button</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">RectangleSelector</span><span class="o">.</span><span class="n">ignore</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xoffset_value</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
       <span class="c"># self.leaf_offset = 4</span>
       <span class="c"># self.leaf_valign = &quot;center&quot;</span>
       <span class="c"># self.leaf_halign = &quot;left&quot;</span>
       <span class="c"># self.branch_offset = -5</span>
       <span class="c"># self.branch_valign = &quot;center&quot;</span>
       <span class="c"># self.branch_halign = &quot;right&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s">&quot;bottom&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_extents</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_pixelsep</span>
        <span class="c">#def testprint(*args):</span>
        <span class="c">#    print &quot;test&quot;</span>
        <span class="c">#if self.interactive:</span>
        <span class="c">#    self.callbacks.connect(&quot;ylim_changed&quot;, testprint)</span>

<div class="viewcode-block" id="Tree.p2y"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.p2y">[docs]</a>    <span class="k">def</span> <span class="nf">p2y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Convert a single display point to y-units&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="k">return</span> <span class="n">transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span></div>
    <span class="k">def</span> <span class="nf">rectselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>
        <span class="n">add</span> <span class="o">=</span> <span class="n">e0</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s">&#39;shift&#39;</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x0</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">):</span>
                <span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">add</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="k">return</span> <span class="n">transform</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">transform</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>

<div class="viewcode-block" id="Tree.xoffset"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.xoffset">[docs]</a>    <span class="k">def</span> <span class="nf">xoffset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Space below x axis to show tick labels.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xoffset_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span></div>
<div class="viewcode-block" id="Tree.set_scaled"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.set_scaled">[docs]</a>    <span class="k">def</span> <span class="nf">set_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">!=</span> <span class="n">scaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span>
        <span class="k">return</span> <span class="n">flag</span>
</div>
<div class="viewcode-block" id="Tree.circle_selected_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.circle_selected_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">circle_selected_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">get</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">_f</span> <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">get</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="p">]</span> <span class="k">if</span> <span class="n">_f</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span> <span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__selected_circled_patch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                                                           <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.select_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.select_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">select_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__selected_circled_patch</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">|</span> <span class="n">nodes</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;app&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circle_selected_nodes</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="n">nodes</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;app&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">circle_selected_nodes</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.rectselect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.rectselect">[docs]</a>    <span class="k">def</span> <span class="nf">rectselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">):</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>
        <span class="n">add</span> <span class="o">=</span> <span class="n">e0</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s">&#39;shift&#39;</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x0</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">):</span>
                <span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_nodes</span><span class="p">(</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="n">add</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="c">## if s:</span>
        <span class="c">##     print &quot;Selected:&quot;</span>
        <span class="c">##     for n in s:</span>
        <span class="c">##         print &quot; &quot;, n</span>

</div>
<div class="viewcode-block" id="Tree.picked"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.picked">[docs]</a>    <span class="k">def</span> <span class="nf">picked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;app&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">picked</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.window2data"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.window2data">[docs]</a>    <span class="k">def</span> <span class="nf">window2data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expandx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">expandy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        return the data coordinates ((x0, y0),(x1, y1)) of the plot</span>
<span class="sd">        window, expanded by relative units of window size</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
        <span class="n">bbx</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="n">expandx</span><span class="p">,</span> <span class="n">expandy</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">bbx</span><span class="o">.</span><span class="n">get_points</span><span class="p">())</span></div>
<div class="viewcode-block" id="Tree.get_visible_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.get_visible_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">get_visible_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labeled_only</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c">## transform = self.transData.inverted().transform</span>
        <span class="c">## bb = self.get_window_extent()</span>
        <span class="c">## bbx = bb.expanded(1.1,1.1)</span>
        <span class="c">## ((x0, y0),(x1, y1)) = transform(bbx.get_points())</span>
        <span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window2data</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
        <span class="c">#print &quot;visible_nodes points&quot;, x0, x1, y0, y1</span>

        <span class="k">if</span> <span class="n">labeled_only</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">y0</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.zoom_cxy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.zoom_cxy">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_cxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom the x and y axes in by the specified proportion of the</span>
<span class="sd">        current view, with a fixed data point (cx, cy)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">();</span> <span class="n">xmid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">();</span> <span class="n">ymid</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
        <span class="n">bbx</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="mf">1.0</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">bbx</span><span class="o">.</span><span class="n">get_points</span><span class="p">())</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">deltax</span> <span class="o">=</span> <span class="n">xmid</span><span class="o">-</span><span class="n">x0</span><span class="p">;</span> <span class="n">deltay</span> <span class="o">=</span> <span class="n">ymid</span><span class="o">-</span><span class="n">y0</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="n">cx</span> <span class="ow">or</span> <span class="n">xmid</span><span class="p">;</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">cy</span> <span class="ow">or</span> <span class="n">ymid</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">cx</span><span class="o">-</span><span class="n">xmid</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmid</span><span class="o">-</span><span class="n">deltax</span><span class="o">+</span><span class="n">xoff</span><span class="p">,</span> <span class="n">xmid</span><span class="o">+</span><span class="n">deltax</span><span class="o">+</span><span class="n">xoff</span><span class="p">)</span>
        <span class="n">yoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">cy</span><span class="o">-</span><span class="n">ymid</span><span class="p">)</span><span class="o">*</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymid</span><span class="o">-</span><span class="n">deltay</span><span class="o">+</span><span class="n">yoff</span><span class="p">,</span> <span class="n">ymid</span><span class="o">+</span><span class="n">deltay</span><span class="o">+</span><span class="n">yoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span> <span class="c"># Added draw_idle</span>
</div>
<div class="viewcode-block" id="Tree.zoom"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.zoom">[docs]</a>    <span class="k">def</span> <span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom the x and y axes in by the specified proportion of the</span>
<span class="sd">        current view.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># get the function to convert display coordinates to data</span>
        <span class="c"># coordinates</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span>
        <span class="n">bbx</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="mf">1.0</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">bbx</span><span class="o">.</span><span class="n">get_points</span><span class="p">())</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">deltax</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">deltay</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">deltax</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">deltax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">deltay</span><span class="p">,</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">deltay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span> <span class="c"># Added draw_idle</span>
</div>
<div class="viewcode-block" id="Tree.center_y"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.center_y">[docs]</a>    <span class="k">def</span> <span class="nf">center_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center the y-axis of the canvas on the given y value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">yoff</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yoff</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">yoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.center_x"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.center_x">[docs]</a>    <span class="k">def</span> <span class="nf">center_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center the x-axis of the canvas on the given x value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
        <span class="n">xoff</span> <span class="o">=</span> <span class="n">xspan</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">xspan</span><span class="o">*</span><span class="n">offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xoff</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">xoff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.center_node"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.center_node">[docs]</a>    <span class="k">def</span> <span class="nf">center_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center the canvas on the given node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.find"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find node(s) matching pattern s and zoom to node(s)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.zoom_nodes"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.zoom_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">();</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">);</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>

        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">[</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="p">]</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="n">Bbox</span><span class="p">(((</span><span class="n">xmin</span><span class="p">,</span><span class="n">ymin</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)))</span>

        <span class="c"># convert data coordinates to display coordinates</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">disp_bb</span> <span class="o">=</span> <span class="p">[</span><span class="n">Bbox</span><span class="p">(</span><span class="n">transform</span><span class="p">(</span><span class="n">bb</span><span class="p">))]</span>


        <span class="n">disp_bb</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">disp_bb</span><span class="p">)</span><span class="o">.</span><span class="n">expanded</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="n">border</span><span class="p">)</span>

        <span class="c"># convert back to data coordinates</span>
        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">disp_bb</span><span class="p">)</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.zoom_clade"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.zoom_clade">[docs]</a>    <span class="k">def</span> <span class="nf">zoom_clade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anc</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">anc</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_node</span><span class="p">(</span><span class="n">anc</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zoom_nodes</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">anc</span><span class="p">),</span> <span class="n">border</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span> <span class="c"># Added draw_idle</span>
</div>
<div class="viewcode-block" id="Tree.ypp"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.ypp">[docs]</a>    <span class="k">def</span> <span class="nf">ypp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)))[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="o">-</span><span class="n">p0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">home</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replot the tree</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">layout</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">home</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Tree.set_name"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.set_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">at</span> <span class="o">=</span> <span class="n">AnchoredText</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s">&quot;bold&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">at</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">at</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">&quot;white&quot;</span><span class="p">)</span>
            <span class="n">at</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">at</span>
</div>
    <span class="k">def</span> <span class="nf">_path_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For use in drawing branches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">];</span> <span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">];</span> <span class="n">px</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">x</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">y</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">)]</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">verts</span><span class="p">,</span> <span class="n">codes</span>
        <span class="c">## return [PathPatch(Path(verts, codes), fill=False,</span>
        <span class="c">##                   linewidth=width or self.branch_width,</span>
        <span class="c">##                   edgecolor=color or self.branch_color)]</span>


<div class="viewcode-block" id="Tree.layout"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.layout">[docs]</a>    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get coordinates of nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span> <span class="o">=</span> <span class="n">cartesian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span> <span class="n">yunit</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                             <span class="n">smooth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">smooth_xpos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xoff</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yoff</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
            <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">sv</span><span class="c">#numpy.array(sv)</span>
</div>
<div class="viewcode-block" id="Tree.set_root"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.set_root">[docs]</a>    <span class="k">def</span> <span class="nf">set_root</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">leaves</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leaf_hsep</span> <span class="o">=</span> <span class="mf">1.0</span><span class="c">#/float(self.nleaves)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">descendants</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="o">=</span><span class="bp">False</span><span class="p">;</span> <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.plot_tree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.plot_tree">[docs]</a>    <span class="k">def</span> <span class="nf">plot_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw branches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">root</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_branch_artists</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mark_named</span><span class="p">()</span>
        <span class="c">## self.home()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactive</span><span class="p">:</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot;&quot;</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span>
        <span class="c">#self.yaxis.set_major_formatter(FuncFormatter(fmt))</span>

        <span class="k">return</span> <span class="bp">self</span>
</div>
<div class="viewcode-block" id="Tree.clade_dimensions"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.clade_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">clade_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">def</span> <span class="nf">recurse</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n2c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="n">recurse</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">n2c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isleaf</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n2c</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">point</span><span class="p">()</span>
                    <span class="n">x0</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">n2c</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
                <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
                <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">recurse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">n2c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>
</div>
<div class="viewcode-block" id="Tree.clade_height_pixels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.clade_height_pixels">[docs]</a>    <span class="k">def</span> <span class="nf">clade_height_pixels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ypp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ypp</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clade_dimensions</span><span class="p">()</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="n">ypp</span>
        <span class="k">return</span> <span class="n">h</span>
</div>
<div class="viewcode-block" id="Tree.create_branch_artists"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.create_branch_artists">[docs]</a>    <span class="k">def</span> <span class="nf">create_branch_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use MPL Paths to draw branches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">## patches = []</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">descendants</span><span class="p">():</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path_to_parent</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchpatch</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_width</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_color</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branchpatch</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.adjust_xspine"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.adjust_xspine">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_xspine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">iter_ticks</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">t</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.mark_named"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.mark_named">[docs]</a>    <span class="k">def</span> <span class="nf">mark_named</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mark_named</span><span class="p">:</span>
            <span class="n">n2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span>
            <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">label</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">n</span><span class="o">.</span><span class="n">isleaf</span><span class="p">)</span> <span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cv</span> <span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cv</span> <span class="p">]</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">y</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Tree.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">v</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span><span class="p">:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;leftwards&quot;</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>

        <span class="n">xspan</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">;</span> <span class="n">xpad</span> <span class="o">=</span> <span class="n">xspan</span><span class="o">*</span><span class="mf">0.05</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">;</span> <span class="n">ypad</span> <span class="o">=</span> <span class="n">yspan</span><span class="o">*</span><span class="mf">0.05</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">-</span><span class="n">xpad</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="n">xpad</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">-</span><span class="n">ypad</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="n">ypad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span> <span class="c"># Warning: Had to add this line for this to work. Still don&#39;t know why.</span>
</div>
<div class="viewcode-block" id="Tree.scroll"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.scroll">[docs]</a>    <span class="k">def</span> <span class="nf">scroll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">xd</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
        <span class="n">yd</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">*</span><span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">xd</span><span class="p">,</span> <span class="n">x1</span><span class="o">+</span><span class="n">xd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span><span class="o">+</span><span class="n">yd</span><span class="p">,</span> <span class="n">y1</span><span class="o">+</span><span class="n">yd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Tree.leaf_pixelsep"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.leaf_pixelsep">[docs]</a>    <span class="k">def</span> <span class="nf">leaf_pixelsep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nleaves</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">display_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span><span class="p">(((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)))</span>
        <span class="c"># height in pixels (visible y data extent)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">display_points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">pixelsep</span> <span class="o">=</span> <span class="n">height</span><span class="o">/</span><span class="p">((</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_hsep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pixelsep</span></div>
<div class="viewcode-block" id="Tree.draw_labels"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.draw_labels">[docs]</a>    <span class="k">def</span> <span class="nf">draw_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s">&quot;leaflabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="s">&quot;vis&quot;</span><span class="p">]:</span>
            <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="p">]</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">leaves</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible_nodes</span><span class="p">(</span><span class="n">labeled_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isleaf</span><span class="p">])</span>
            <span class="n">psep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_pixelsep</span><span class="p">()</span>
            <span class="n">fontsize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">psep</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">n2l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span><span class="o">.</span><span class="n">transform</span>
            <span class="n">sub</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">sub</span>

            <span class="c"># draw leaves</span>
            <span class="n">leaves_drawn</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">leaves_drawn</span><span class="p">:</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="n">leaves_drawn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
                    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                    <span class="k">continue</span>

                <span class="n">txt2</span> <span class="o">=</span> <span class="n">leaves_drawn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s">&quot;phylogram&quot;</span><span class="p">:</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="o">*</span><span class="n">transform</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="n">y0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">y1</span><span class="p">]))[:,</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">],[</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">]))</span>
                    <span class="n">xd</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">yd</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">sep</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">xd</span><span class="p">,</span> <span class="n">yd</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="n">fontsize</span><span class="p">:</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
                    <span class="n">leaves_drawn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span> <span class="o">==</span> <span class="s">&quot;radial&quot;</span><span class="p">:</span>
                <span class="c"># Checking to see if the last label overlaps with the first one</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="n">leaves_drawn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">txt2</span> <span class="o">=</span> <span class="n">leaves_drawn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">y0</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">],[</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">]))</span>
                <span class="n">xd</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">yd</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">xd</span><span class="p">,</span> <span class="n">yd</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">sep</span> <span class="o">&lt;=</span> <span class="n">fontsize</span><span class="p">:</span>
                    <span class="n">txt</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">leaves_drawn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
            <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">leaves_drawn</span><span class="p">:</span>
                <span class="n">leaves_drawn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="c">## print [ x[0].id for x in nodes ]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s">&quot;branchlabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="s">&quot;vis&quot;</span><span class="p">]:</span>
                <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible_nodes</span><span class="p">(</span><span class="n">labeled_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">branches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isleaf</span><span class="p">)])</span>
                <span class="n">n2l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node2label</span>
                <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">n2l</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span></div>
<div class="viewcode-block" id="Tree.hardcopy"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.Tree.hardcopy">[docs]</a>    <span class="k">def</span> <span class="nf">hardcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">leafpad</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">HC</span><span class="o">.</span><span class="n">TreeFigure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">relwidth</span><span class="o">=</span><span class="n">relwidth</span><span class="p">,</span> <span class="n">leafpad</span><span class="o">=</span><span class="n">leafpad</span><span class="p">,</span>
                          <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                          <span class="n">leaf_fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaf_fontsize</span><span class="p">,</span>
                          <span class="n">branch_fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">branch_fontsize</span><span class="p">,</span>
                          <span class="n">branch_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_width</span><span class="p">,</span>
                          <span class="n">branch_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_color</span><span class="p">,</span>
                          <span class="n">branchlabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span><span class="p">,</span>
                          <span class="n">layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                          <span class="n">leaflabels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">leaflabels</span><span class="p">,</span>
                          <span class="n">xlim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span>
                          <span class="n">ylim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">(),</span>
                          <span class="n">plottype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plottype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span>
</div></div>
<div class="viewcode-block" id="RadialTree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.RadialTree">[docs]</a><span class="k">class</span> <span class="nc">RadialTree</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matplotlib axes subclass for rendering radial trees</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fig</span><span class="p">,</span><span class="n">rect</span><span class="p">,</span><span class="n">tf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">Tree</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fig</span><span class="p">,</span><span class="n">rect</span><span class="p">,</span><span class="n">tf</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&quot;equal&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="RadialTree.layout"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.RadialTree.layout">[docs]</a>    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">..layout_polar</span> <span class="kn">import</span> <span class="n">calc_node_positions</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;start&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;end&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span> <span class="o">=</span> <span class="n">calc_node_positions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled</span><span class="p">,</span>
                                       <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
        <span class="c"># Sort by angle for polar coordinates</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
            <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="p">[</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sv</span> <span class="p">]</span> <span class="c"># We only want coords, not angle</span>

    <span class="c">## def _path_to_parent(self, node, width=None, color=None):</span>
    <span class="c">##     c = self.n2c[node]; theta1 = c.angle; r = c.depth</span>
    <span class="c">##     M = Path.MOVETO; L = Path.LINETO</span>
    <span class="c">##     pc = self.n2c[node.parent]; theta2 = pc.angle</span>
    <span class="c">##     px1 = math.cos(math.radians(c.angle))*pc.depth</span>
    <span class="c">##     py1 = math.sin(math.radians(c.angle))*pc.depth</span>
    <span class="c">##     verts = [(c.x,c.y),(px1,py1)]; codes = [M,L]</span>
    <span class="c">##     #verts.append((pc.x,pc.y)); codes.append(L)</span>
    <span class="c">##     path = PathPatch(Path(verts, codes), fill=False,</span>
    <span class="c">##                      linewidth=width or self.branch_width,</span>
    <span class="c">##                      edgecolor=color or self.branch_color)</span>
    <span class="c">##     diam = pc.depth*2</span>
    <span class="c">##     t1, t2 = tuple(sorted((theta1,theta2)))</span>
    <span class="c">##     arc = Arc((0,0), diam, diam, theta1=t1, theta2=t2,</span>
    <span class="c">##               edgecolor=color or self.branch_color,</span>
    <span class="c">##               linewidth=width or self.branch_width)</span>
    <span class="c">##     return [path, arc]</span>
</div>
    <span class="k">def</span> <span class="nf">_path_to_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="p">];</span> <span class="n">theta1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">;</span> <span class="n">L</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="p">];</span> <span class="n">theta2</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">angle</span>
        <span class="n">px1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">py1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">),(</span><span class="n">px1</span><span class="p">,</span><span class="n">py1</span><span class="p">)];</span> <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="n">L</span><span class="p">]</span>
        <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">((</span><span class="n">theta1</span><span class="p">,</span><span class="n">theta2</span><span class="p">)))</span>
        <span class="n">diam</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">depth</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">arc</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">diam</span><span class="p">,</span> <span class="n">diam</span><span class="p">,</span> <span class="n">theta1</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="n">t2</span><span class="p">)</span>
        <span class="n">arcpath</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>
        <span class="n">av</span> <span class="o">=</span> <span class="n">arcpath</span><span class="o">.</span><span class="n">vertices</span> <span class="o">*</span> <span class="n">pc</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="n">arcpath</span><span class="o">.</span><span class="n">codes</span>
        <span class="n">verts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">verts</span><span class="p">,</span> <span class="n">codes</span>

</div>
<div class="viewcode-block" id="OverviewTree"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree">[docs]</a><span class="k">class</span> <span class="nc">OverviewTree</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;leaflabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&quot;branchlabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">Tree</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_overview_rect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype</span><span class="o">=</span><span class="s">&quot;overview&quot;</span>

<div class="viewcode-block" id="OverviewTree.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transData</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">v</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n2c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;rightwards&quot;</span><span class="p">:</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;leftwards&quot;</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span> <span class="p">]))</span>
        <span class="n">xspan</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">;</span> <span class="n">xpad</span> <span class="o">=</span> <span class="n">xspan</span><span class="o">*</span><span class="mf">0.05</span>
        <span class="n">yspan</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">;</span> <span class="n">ypad</span> <span class="o">=</span> <span class="n">yspan</span><span class="o">*</span><span class="mf">0.05</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">-</span><span class="n">xpad</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="n">xpad</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">-</span><span class="n">ypad</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="n">ypad</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_xspine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span> <span class="c"># Warning: Had to add this line for this to work. Still don&#39;t know why.</span>
</div>
<div class="viewcode-block" id="OverviewTree.rectselect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree.rectselect">[docs]</a>    <span class="k">def</span> <span class="nf">rectselect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Zoom to the selected region</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">e0</span><span class="o">.</span><span class="n">ydata</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s">&quot;leftwards&quot;</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span><span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span><span class="n">x0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="OverviewTree.set_target"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree.set_target">[docs]</a>    <span class="k">def</span> <span class="nf">set_target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>
</div>
<div class="viewcode-block" id="OverviewTree.add_overview_rect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree.add_overview_rect">[docs]</a>    <span class="k">def</span> <span class="nf">add_overview_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">UpdatingRect</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomrect</span> <span class="o">=</span> <span class="n">rect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="c">## if pyplot.isinteractive():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;xlim_changed&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;ylim_changed&#39;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="OverviewTree.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Tree</span><span class="o">.</span><span class="n">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_overview_rect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span></div>
<div class="viewcode-block" id="OverviewTree.redraw_keeptemp"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.OverviewTree.redraw_keeptemp">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_keeptemp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Tree</span><span class="o">.</span><span class="n">redraw_keeptemp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_overview_rect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

<span class="c"># TODO: facing plots</span></div></div>
<div class="viewcode-block" id="MultiTreeFigure"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure">[docs]</a><span class="k">class</span> <span class="nc">MultiTreeFigure</span><span class="p">(</span><span class="n">TreeFigure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for drawing multiple trees in one figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trees</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                 <span class="n">scaled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">radial</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *trees* are assumed to be objects suitable for passing to</span>
<span class="sd">        ivy.tree.read()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">branchlabels</span> <span class="o">=</span> <span class="n">branchlabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radial</span> <span class="o">=</span> <span class="n">radial</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">divs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">SubplotParams</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.04</span>
            <span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">subplotpars</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>
        <span class="n">events</span><span class="o">.</span><span class="n">connect_events</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">fig</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">trees</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="n">scaled</span><span class="p">,</span>
                     <span class="n">branchlabels</span><span class="o">=</span><span class="n">branchlabels</span><span class="p">)</span>

<div class="viewcode-block" id="MultiTreeFigure.add"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">branchlabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">leaflabels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add tree to existing figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">Node</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s">&quot;cannot coerce data into tree.Node&quot;</span><span class="p">)</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">root</span><span class="o">.</span><span class="n">treename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">):</span>
            <span class="n">p</span><span class="o">.</span><span class="n">change_geometry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span> <span class="o">=</span> <span class="n">TreePlot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">tf</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
                       <span class="n">scaled</span><span class="o">=</span><span class="n">scaled</span><span class="p">,</span> <span class="n">branchlabels</span><span class="o">=</span><span class="n">branchlabels</span><span class="p">,</span>
                       <span class="n">leaflabels</span><span class="o">=</span><span class="n">leaflabels</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">plt</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_root</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
        <span class="n">p</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span></div>
<div class="viewcode-block" id="MultiTreeFigure.show"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.redraw"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.redraw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.ladderize"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.ladderize">[docs]</a>    <span class="k">def</span> <span class="nf">ladderize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">ladderize</span><span class="p">(</span><span class="n">reverse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span></div>
<div class="viewcode-block" id="MultiTreeFigure.home"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">home</span><span class="p">()</span>
        <span class="c">## global IP</span>
        <span class="c">## if IP:</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.highlight(s)</span>
        <span class="c">##         return sorted([ x.label for x in self.highlighted ])</span>
        <span class="c">##     IP.expose_magic(&quot;highlight&quot;, f)</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.root.ladderize()</span>
        <span class="c">##         self.redraw()</span>
        <span class="c">##     IP.expose_magic(&quot;ladderize&quot;, f)</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.show()</span>
        <span class="c">##     IP.expose_magic(&quot;show&quot;, f)</span>
        <span class="c">##     def f(shell, s):</span>
        <span class="c">##         self.redraw()</span>
        <span class="c">##     IP.expose_magic(&quot;redraw&quot;, f)</span>
        <span class="k">return</span> <span class="n">p</span></div>
<div class="viewcode-block" id="MultiTreeFigure.on_nodes_selected"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.on_nodes_selected">[docs]</a>    <span class="k">def</span> <span class="nf">on_nodes_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">treeplot</span><span class="p">):</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.clear"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highlighted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">divs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.picked"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.picked">[docs]</a>    <span class="k">def</span> <span class="nf">picked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">button</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">artist</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
</div>
<div class="viewcode-block" id="MultiTreeFigure.getplot"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.MultiTreeFigure.getplot">[docs]</a>    <span class="k">def</span> <span class="nf">getplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name2plot</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="UpdatingRect"><a class="viewcode-back" href="../../../ivy.vis.html#ivy.vis.treevis.UpdatingRect">[docs]</a><span class="k">class</span> <span class="nc">UpdatingRect</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">):</span> <span class="c"># Used in overview plot</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">viewLim</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">draw_labels</span><span class="p">()</span>
        <span class="n">p</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</div>
<span class="n">TreePlot</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">Tree</span><span class="p">)</span>
<span class="n">RadialTreePlot</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">RadialTree</span><span class="p">)</span>
<span class="n">OverviewTreePlot</span> <span class="o">=</span> <span class="n">subplot_class_factory</span><span class="p">(</span><span class="n">OverviewTree</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">ivy 0.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, RR, CZ.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>